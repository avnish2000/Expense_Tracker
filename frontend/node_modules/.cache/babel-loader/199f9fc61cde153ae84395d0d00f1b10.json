{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n};\n\nimport { Group } from \"../../../scene/group\";\nimport { Selection } from \"../../../scene/selection\";\nimport { Rect } from \"../../../scene/shape/rect\";\nimport { Text } from \"../../../scene/shape/text\";\nimport { Label } from \"../../label\";\nimport { PointerEvents } from \"../../../scene/node\";\nimport { CartesianSeries } from \"./cartesianSeries\";\nimport { ChartAxisDirection } from \"../../chartAxis\";\nimport { toTooltipHtml } from \"../../chart\";\nimport { numericExtent, finiteExtent } from \"../../../util/array\";\nimport { toFixed } from \"../../../util/number\";\nimport { reactive } from \"../../../util/observable\";\nimport ticks, { tickStep } from \"../../../util/ticks\";\nvar HistogramSeriesNodeTag;\n\n(function (HistogramSeriesNodeTag) {\n  HistogramSeriesNodeTag[HistogramSeriesNodeTag[\"Bin\"] = 0] = \"Bin\";\n  HistogramSeriesNodeTag[HistogramSeriesNodeTag[\"Label\"] = 1] = \"Label\";\n})(HistogramSeriesNodeTag || (HistogramSeriesNodeTag = {}));\n\nvar HistogramSeriesLabel =\n/** @class */\nfunction (_super) {\n  __extends(HistogramSeriesLabel, _super);\n\n  function HistogramSeriesLabel() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  __decorate([reactive('change')], HistogramSeriesLabel.prototype, \"formatter\", void 0);\n\n  return HistogramSeriesLabel;\n}(Label);\n\nvar defaultBinCount = 10;\nvar aggregationFunctions = {\n  count: function (bin) {\n    return bin.data.length;\n  },\n  sum: function (bin, yKey) {\n    return bin.data.reduce(function (acc, datum) {\n      return acc + datum[yKey];\n    }, 0);\n  },\n  mean: function (bin, yKey) {\n    return aggregationFunctions.sum(bin, yKey) / aggregationFunctions.count(bin, yKey);\n  }\n};\n\nvar HistogramBin =\n/** @class */\nfunction () {\n  function HistogramBin(_a) {\n    var domainMin = _a[0],\n        domainMax = _a[1];\n    this.data = [];\n    this.aggregatedValue = 0;\n    this.frequency = 0;\n    this.domain = [domainMin, domainMax];\n  }\n\n  ;\n\n  HistogramBin.prototype.addDatum = function (datum) {\n    this.data.push(datum);\n    this.frequency++;\n  };\n\n  ;\n  Object.defineProperty(HistogramBin.prototype, \"domainWidth\", {\n    get: function () {\n      var _a = this.domain,\n          domainMin = _a[0],\n          domainMax = _a[1];\n      return domainMax - domainMin;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramBin.prototype, \"relativeHeight\", {\n    get: function () {\n      return this.aggregatedValue / this.domainWidth;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  ;\n\n  HistogramBin.prototype.calculateAggregatedValue = function (aggregationName, yKey) {\n    if (!yKey) {\n      // not having a yKey forces us into a frequency plot\n      aggregationName = 'count';\n    }\n\n    var aggregationFunction = aggregationFunctions[aggregationName];\n    this.aggregatedValue = aggregationFunction(this, yKey);\n  };\n\n  HistogramBin.prototype.getY = function (areaPlot) {\n    return areaPlot ? this.relativeHeight : this.aggregatedValue;\n  };\n\n  return HistogramBin;\n}();\n\nexport { HistogramBin };\n;\n\nvar HistogramSeries =\n/** @class */\nfunction (_super) {\n  __extends(HistogramSeries, _super);\n\n  function HistogramSeries() {\n    var _a;\n\n    var _this = _super.call(this) || this; // Need to put column and label nodes into separate groups, because even though label nodes are\n    // created after the column nodes, this only guarantees that labels will always be on top of columns\n    // on the first run. If on the next run more columns are added, they might clip the labels\n    // rendered during the previous run.\n\n\n    _this.rectGroup = _this.group.appendChild(new Group());\n    _this.textGroup = _this.group.appendChild(new Group());\n    _this.rectSelection = Selection.select(_this.rectGroup).selectAll();\n    _this.textSelection = Selection.select(_this.textGroup).selectAll();\n    _this.binnedData = [];\n    _this.xDomain = [];\n    _this.yDomain = [];\n    _this.label = new HistogramSeriesLabel();\n    _this.seriesItemEnabled = true;\n    _this.fill = undefined;\n    _this.stroke = undefined;\n    _this.fillOpacity = 1;\n    _this.strokeOpacity = 1;\n    _this.lineDash = undefined;\n    _this.lineDashOffset = 0;\n    _this.directionKeys = (_a = {}, _a[ChartAxisDirection.X] = ['xKey'], _a[ChartAxisDirection.Y] = ['yKey'], _a);\n    _this._xKey = '';\n    _this._areaPlot = false;\n    _this._xName = '';\n    _this._yKey = '';\n    _this._yName = '';\n    _this._strokeWidth = 1;\n    _this.highlightStyle = {\n      fill: 'yellow'\n    };\n    _this.label.enabled = false;\n\n    _this.label.addEventListener('change', _this.update, _this);\n\n    return _this;\n  }\n\n  HistogramSeries.prototype.getKeys = function (direction) {\n    var _this = this;\n\n    var directionKeys = this.directionKeys;\n    var keys = directionKeys && directionKeys[direction];\n    var values = [];\n\n    if (keys) {\n      keys.forEach(function (key) {\n        var value = _this[key];\n\n        if (value) {\n          if (Array.isArray(value)) {\n            values.push.apply(values, value);\n          } else {\n            values.push(value);\n          }\n        }\n      });\n    }\n\n    return values;\n  };\n\n  Object.defineProperty(HistogramSeries.prototype, \"xKey\", {\n    get: function () {\n      return this._xKey;\n    },\n    set: function (value) {\n      if (this._xKey !== value) {\n        this._xKey = value;\n        this.scheduleData();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"areaPlot\", {\n    get: function () {\n      return this._areaPlot;\n    },\n    set: function (c) {\n      this._areaPlot = c;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"bins\", {\n    get: function () {\n      return this._bins;\n    },\n    set: function (bins) {\n      this._bins = bins;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"aggregation\", {\n    get: function () {\n      return this._aggregation;\n    },\n    set: function (aggregation) {\n      this._aggregation = aggregation;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"binCount\", {\n    get: function () {\n      return this._binCount;\n    },\n    set: function (binCount) {\n      this._binCount = binCount;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"xName\", {\n    get: function () {\n      return this._xName;\n    },\n    set: function (value) {\n      if (this._xName !== value) {\n        this._xName = value;\n        this.update();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"yKey\", {\n    get: function () {\n      return this._yKey;\n    },\n    set: function (yKey) {\n      this._yKey = yKey;\n      this.seriesItemEnabled = true;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"yName\", {\n    get: function () {\n      return this._yName;\n    },\n    set: function (values) {\n      this._yName = values;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"strokeWidth\", {\n    get: function () {\n      return this._strokeWidth;\n    },\n    set: function (value) {\n      if (this._strokeWidth !== value) {\n        this._strokeWidth = value;\n        this.update();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"shadow\", {\n    get: function () {\n      return this._shadow;\n    },\n    set: function (value) {\n      if (this._shadow !== value) {\n        this._shadow = value;\n        this.update();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  HistogramSeries.prototype.onHighlightChange = function () {\n    this.updateRectNodes();\n  };\n\n  HistogramSeries.prototype.setColors = function (fills, strokes) {\n    this.fill = fills[0];\n    this.stroke = strokes[0];\n  };\n  /*  during processData phase, used to unify different ways of the user specifying\n      the bins. Returns bins in format [[min1, max1], [min2, max2] ... ] */\n\n\n  HistogramSeries.prototype.deriveBins = function () {\n    var _this = this;\n\n    var _a = this,\n        bins = _a.bins,\n        binCount = _a.binCount;\n\n    if (!this.data) {\n      return [];\n    }\n\n    if (bins && binCount) {\n      console.warn('bin domain and bin count both specified - these are mutually exclusive properties');\n    }\n\n    if (bins) {\n      // we have explicity set bins from user. Use those.\n      return bins;\n    }\n\n    var xData = this.data.map(function (datum) {\n      return datum[_this.xKey];\n    });\n    var xDomain = this.fixNumericExtent(finiteExtent(xData), 'x');\n    var binStarts = ticks(xDomain[0], xDomain[1], this.binCount || defaultBinCount);\n    var binSize = tickStep(xDomain[0], xDomain[1], this.binCount || defaultBinCount);\n    var firstBinEnd = binStarts[0];\n\n    var expandStartToBin = function (n) {\n      return [n, n + binSize];\n    };\n\n    return __spreadArrays([[firstBinEnd - binSize, firstBinEnd]], binStarts.map(expandStartToBin));\n  };\n\n  HistogramSeries.prototype.placeDataInBins = function (data) {\n    var _this = this;\n\n    var xKey = this.xKey;\n    var derivedBins = this.deriveBins(); // creating a sorted copy allows binning in O(n) rather than O(nÂ²)\n    // but at the expense of more temporary memory\n\n    var sortedData = data.slice().sort(function (a, b) {\n      if (a[xKey] < b[xKey]) {\n        return -1;\n      }\n\n      if (a[xKey] > b[xKey]) {\n        return 1;\n      }\n\n      return 0;\n    });\n    var currentBin = 0;\n    var bins = [new HistogramBin(derivedBins[0])];\n    sortedData.forEach(function (datum) {\n      while (datum[xKey] > derivedBins[currentBin][1]) {\n        currentBin++;\n        bins.push(new HistogramBin(derivedBins[currentBin]));\n      }\n\n      bins[currentBin].addDatum(datum);\n    });\n    bins.forEach(function (b) {\n      return b.calculateAggregatedValue(_this._aggregation, _this.yKey);\n    });\n    return bins;\n  };\n\n  Object.defineProperty(HistogramSeries.prototype, \"xMax\", {\n    get: function () {\n      var _this = this;\n\n      return this.data && this.data.reduce(function (acc, datum) {\n        return Math.max(acc, datum[_this.xKey]);\n      }, Number.NEGATIVE_INFINITY);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  HistogramSeries.prototype.processData = function () {\n    var _this = this;\n\n    var _a = this,\n        xKey = _a.xKey,\n        data = _a.data;\n\n    this.binnedData = this.placeDataInBins(xKey && data ? data : []);\n    var yData = this.binnedData.map(function (b) {\n      return b.getY(_this.areaPlot);\n    });\n    var yMinMax = numericExtent(yData);\n    this.yDomain = this.fixNumericExtent([0, yMinMax ? yMinMax[1] : 1], 'y');\n    var firstBin = this.binnedData[0];\n    var lastBin = this.binnedData[this.binnedData.length - 1];\n    var xMin = firstBin.domain[0];\n    var xMax = lastBin.domain[1];\n    this.xDomain = [xMin, xMax];\n    this.fireEvent({\n      type: 'dataProcessed'\n    });\n    return true;\n  };\n\n  HistogramSeries.prototype.getDomain = function (direction) {\n    if (direction === ChartAxisDirection.X) {\n      return this.xDomain;\n    } else {\n      return this.yDomain;\n    }\n  };\n\n  HistogramSeries.prototype.fireNodeClickEvent = function (datum) {\n    this.fireEvent({\n      type: 'nodeClick',\n      series: this,\n      datum: datum.seriesDatum,\n      xKey: this.xKey\n    });\n  };\n\n  HistogramSeries.prototype.update = function () {\n    var _a = this,\n        visible = _a.visible,\n        chart = _a.chart,\n        xAxis = _a.xAxis,\n        yAxis = _a.yAxis;\n\n    this.group.visible = visible;\n\n    if (!xAxis || !yAxis || !visible || !chart || chart.layoutPending || chart.dataPending) {\n      return;\n    }\n\n    var nodeData = this.generateNodeData();\n    this.updateRectSelection(nodeData);\n    this.updateRectNodes();\n    this.updateTextSelection(nodeData);\n    this.updateTextNodes();\n  };\n\n  HistogramSeries.prototype.generateNodeData = function () {\n    var _this = this;\n\n    if (!this.seriesItemEnabled) {\n      return [];\n    }\n\n    var _a = this,\n        xScale = _a.xAxis.scale,\n        yScale = _a.yAxis.scale,\n        fill = _a.fill,\n        stroke = _a.stroke,\n        strokeWidth = _a.strokeWidth;\n\n    var nodeData = [];\n\n    var defaultLabelFormatter = function (params) {\n      return String(params.value);\n    };\n\n    var _b = this.label,\n        _c = _b.formatter,\n        labelFormatter = _c === void 0 ? defaultLabelFormatter : _c,\n        labelFontStyle = _b.fontStyle,\n        labelFontWeight = _b.fontWeight,\n        labelFontSize = _b.fontSize,\n        labelFontFamily = _b.fontFamily,\n        labelColor = _b.color;\n    this.binnedData.forEach(function (binOfData) {\n      var total = binOfData.aggregatedValue,\n          frequency = binOfData.frequency,\n          _a = binOfData.domain,\n          xDomainMin = _a[0],\n          xDomainMax = _a[1],\n          relativeHeight = binOfData.relativeHeight;\n      var xMinPx = xScale.convert(xDomainMin),\n          xMaxPx = xScale.convert(xDomainMax),\n          // note: assuming can't be negative:\n      y = _this.areaPlot ? relativeHeight : _this.yKey ? total : frequency,\n          yZeroPx = yScale.convert(0),\n          yMaxPx = yScale.convert(y),\n          w = xMaxPx - xMinPx,\n          h = Math.abs(yMaxPx - yZeroPx);\n      var selectionDatumLabel = y !== 0 ? {\n        text: labelFormatter({\n          value: binOfData.aggregatedValue\n        }),\n        fontStyle: labelFontStyle,\n        fontWeight: labelFontWeight,\n        fontSize: labelFontSize,\n        fontFamily: labelFontFamily,\n        fill: labelColor,\n        x: xMinPx + w / 2,\n        y: yMaxPx + h / 2\n      } : undefined;\n      nodeData.push({\n        series: _this,\n        seriesDatum: binOfData,\n        // since each selection is an aggregation of multiple data.\n        x: xMinPx,\n        y: yMaxPx,\n        width: w,\n        height: h,\n        fill: fill,\n        stroke: stroke,\n        strokeWidth: strokeWidth,\n        label: selectionDatumLabel\n      });\n    });\n    return nodeData;\n  };\n\n  HistogramSeries.prototype.updateRectSelection = function (nodeData) {\n    var updateRects = this.rectSelection.setData(nodeData);\n    updateRects.exit.remove();\n    var enterRects = updateRects.enter.append(Rect).each(function (rect) {\n      rect.tag = HistogramSeriesNodeTag.Bin;\n      rect.crisp = true;\n    });\n    this.rectSelection = updateRects.merge(enterRects);\n  };\n\n  HistogramSeries.prototype.updateRectNodes = function () {\n    var _this = this;\n\n    if (!this.chart) {\n      return;\n    }\n\n    var highlightedDatum = this.chart.highlightedDatum;\n\n    var _a = this,\n        fillOpacity = _a.fillOpacity,\n        strokeOpacity = _a.strokeOpacity,\n        shadow = _a.shadow,\n        _b = _a.highlightStyle,\n        fill = _b.fill,\n        stroke = _b.stroke;\n\n    this.rectSelection.each(function (rect, datum) {\n      var highlighted = datum === highlightedDatum;\n      rect.x = datum.x;\n      rect.y = datum.y;\n      rect.width = datum.width;\n      rect.height = datum.height;\n      rect.fill = highlighted && fill !== undefined ? fill : datum.fill;\n      rect.stroke = highlighted && stroke !== undefined ? stroke : datum.stroke;\n      rect.fillOpacity = fillOpacity;\n      rect.strokeOpacity = strokeOpacity;\n      rect.strokeWidth = datum.strokeWidth;\n      rect.lineDash = _this.lineDash;\n      rect.lineDashOffset = _this.lineDashOffset;\n      rect.fillShadow = shadow;\n      rect.visible = datum.height > 0; // prevent stroke from rendering for zero height columns\n    });\n  };\n\n  HistogramSeries.prototype.updateTextSelection = function (nodeData) {\n    var updateTexts = this.textSelection.setData(nodeData);\n    updateTexts.exit.remove();\n    var enterTexts = updateTexts.enter.append(Text).each(function (text) {\n      text.tag = HistogramSeriesNodeTag.Label;\n      text.pointerEvents = PointerEvents.None;\n      text.textAlign = 'center';\n      text.textBaseline = 'middle';\n    });\n    this.textSelection = updateTexts.merge(enterTexts);\n  };\n\n  HistogramSeries.prototype.updateTextNodes = function () {\n    var labelEnabled = this.label.enabled;\n    this.textSelection.each(function (text, datum) {\n      var label = datum.label;\n\n      if (label && labelEnabled) {\n        text.text = label.text;\n        text.x = label.x;\n        text.y = label.y;\n        text.fontStyle = label.fontStyle;\n        text.fontWeight = label.fontWeight;\n        text.fontSize = label.fontSize;\n        text.fontFamily = label.fontFamily;\n        text.fill = label.fill;\n        text.visible = true;\n      } else {\n        text.visible = false;\n      }\n    });\n  };\n\n  HistogramSeries.prototype.getTooltipHtml = function (nodeDatum) {\n    var _a = this,\n        xKey = _a.xKey,\n        yKey = _a.yKey;\n\n    if (!xKey) {\n      return '';\n    }\n\n    var _b = this,\n        xName = _b.xName,\n        yName = _b.yName,\n        color = _b.fill,\n        tooltipRenderer = _b.tooltipRenderer,\n        aggregation = _b.aggregation;\n\n    var bin = nodeDatum.seriesDatum;\n    var aggregatedValue = bin.aggregatedValue,\n        frequency = bin.frequency,\n        _c = bin.domain,\n        rangeMin = _c[0],\n        rangeMax = _c[1];\n    var title = (xName || xKey) + \" \" + toFixed(rangeMin) + \" - \" + toFixed(rangeMax);\n    var content = yKey ? \"<b>\" + (yName || yKey) + \" (\" + aggregation + \")</b>: \" + toFixed(aggregatedValue) + \"<br>\" : '';\n    content += \"<b>Frequency</b>: \" + frequency;\n    var defaults = {\n      title: title,\n      titleBackgroundColor: color,\n      content: content\n    };\n\n    if (tooltipRenderer) {\n      return toTooltipHtml(tooltipRenderer({\n        datum: bin,\n        xKey: xKey,\n        xValue: bin.domain,\n        xName: xName,\n        yKey: yKey,\n        yValue: bin.aggregatedValue,\n        yName: yName,\n        color: color\n      }), defaults);\n    }\n\n    return toTooltipHtml(defaults);\n  };\n\n  HistogramSeries.prototype.listSeriesItems = function (legendData) {\n    var _a = this,\n        id = _a.id,\n        data = _a.data,\n        yKey = _a.yKey,\n        yName = _a.yName,\n        seriesItemEnabled = _a.seriesItemEnabled,\n        fill = _a.fill,\n        stroke = _a.stroke,\n        fillOpacity = _a.fillOpacity,\n        strokeOpacity = _a.strokeOpacity;\n\n    if (data && data.length) {\n      legendData.push({\n        id: id,\n        itemId: yKey,\n        enabled: seriesItemEnabled,\n        label: {\n          text: yName || yKey || 'Frequency'\n        },\n        marker: {\n          fill: fill || 'rgba(0, 0, 0, 0)',\n          stroke: stroke || 'rgba(0, 0, 0, 0)',\n          fillOpacity: fillOpacity,\n          strokeOpacity: strokeOpacity\n        }\n      });\n    }\n  };\n\n  HistogramSeries.prototype.toggleSeriesItem = function (itemId, enabled) {\n    if (itemId === this.yKey) {\n      this.seriesItemEnabled = enabled;\n    }\n\n    this.scheduleData();\n  };\n\n  HistogramSeries.className = 'HistogramSeries';\n  HistogramSeries.type = 'histogram';\n\n  __decorate([reactive('dataChange')], HistogramSeries.prototype, \"fill\", void 0);\n\n  __decorate([reactive('dataChange')], HistogramSeries.prototype, \"stroke\", void 0);\n\n  __decorate([reactive('layoutChange')], HistogramSeries.prototype, \"fillOpacity\", void 0);\n\n  __decorate([reactive('layoutChange')], HistogramSeries.prototype, \"strokeOpacity\", void 0);\n\n  __decorate([reactive('update')], HistogramSeries.prototype, \"lineDash\", void 0);\n\n  __decorate([reactive('update')], HistogramSeries.prototype, \"lineDashOffset\", void 0);\n\n  return HistogramSeries;\n}(CartesianSeries);\n\nexport { HistogramSeries };","map":{"version":3,"sources":["E:/Expense-Tracker/frontend/node_modules/ag-charts-community/dist/es6/chart/series/cartesian/histogramSeries.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__spreadArrays","s","il","k","a","j","jl","Group","Selection","Rect","Text","Label","PointerEvents","CartesianSeries","ChartAxisDirection","toTooltipHtml","numericExtent","finiteExtent","toFixed","reactive","ticks","tickStep","HistogramSeriesNodeTag","HistogramSeriesLabel","_super","apply","defaultBinCount","aggregationFunctions","count","bin","data","sum","yKey","reduce","acc","datum","mean","HistogramBin","_a","domainMin","domainMax","aggregatedValue","frequency","domain","addDatum","push","get","enumerable","configurable","domainWidth","calculateAggregatedValue","aggregationName","aggregationFunction","getY","areaPlot","relativeHeight","HistogramSeries","_this","call","rectGroup","group","appendChild","textGroup","rectSelection","select","selectAll","textSelection","binnedData","xDomain","yDomain","label","seriesItemEnabled","fill","undefined","stroke","fillOpacity","strokeOpacity","lineDash","lineDashOffset","directionKeys","X","Y","_xKey","_areaPlot","_xName","_yKey","_yName","_strokeWidth","highlightStyle","enabled","addEventListener","update","getKeys","direction","keys","values","forEach","value","isArray","set","scheduleData","_bins","bins","_aggregation","aggregation","_binCount","binCount","_shadow","onHighlightChange","updateRectNodes","setColors","fills","strokes","deriveBins","console","warn","xData","map","xKey","fixNumericExtent","binStarts","binSize","firstBinEnd","expandStartToBin","n","placeDataInBins","derivedBins","sortedData","slice","sort","currentBin","Math","max","Number","NEGATIVE_INFINITY","processData","yData","yMinMax","firstBin","lastBin","xMin","xMax","fireEvent","type","getDomain","fireNodeClickEvent","series","seriesDatum","visible","chart","xAxis","yAxis","layoutPending","dataPending","nodeData","generateNodeData","updateRectSelection","updateTextSelection","updateTextNodes","xScale","scale","yScale","strokeWidth","defaultLabelFormatter","params","String","_b","_c","formatter","labelFormatter","labelFontStyle","fontStyle","labelFontWeight","fontWeight","labelFontSize","fontSize","labelFontFamily","fontFamily","labelColor","color","binOfData","total","xDomainMin","xDomainMax","xMinPx","convert","xMaxPx","y","yZeroPx","yMaxPx","w","h","abs","selectionDatumLabel","text","x","width","height","updateRects","setData","exit","remove","enterRects","enter","append","each","rect","tag","Bin","crisp","merge","highlightedDatum","shadow","highlighted","fillShadow","updateTexts","enterTexts","pointerEvents","None","textAlign","textBaseline","labelEnabled","getTooltipHtml","nodeDatum","xName","yName","tooltipRenderer","rangeMin","rangeMax","title","content","defaults","titleBackgroundColor","xValue","yValue","listSeriesItems","legendData","id","itemId","marker","toggleSeriesItem","className"],"mappings":"AAAA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;AACrD,MAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAChCF,IAAAA,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;AAAEC,MAAAA,SAAS,EAAE;AAAb,iBAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;AAAED,MAAAA,CAAC,CAACI,SAAF,GAAcH,CAAd;AAAkB,KAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AAAE,WAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIA,CAAC,CAACM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AAAc,KAF9E;;AAGA,WAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;AACH,GALD;;AAMA,SAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACnBF,IAAAA,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;AACA,aAASO,EAAT,GAAc;AAAE,WAAKC,WAAL,GAAmBT,CAAnB;AAAuB;;AACvCA,IAAAA,CAAC,CAACU,SAAF,GAAcT,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,EAAE,CAACE,SAAH,GAAeT,CAAC,CAACS,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;AACH,GAJD;AAKH,CAZ2C,EAA5C;;AAaA,IAAII,UAAU,GAAI,QAAQ,KAAKA,UAAd,IAA6B,UAAUC,UAAV,EAAsBC,MAAtB,EAA8BC,GAA9B,EAAmCC,IAAnC,EAAyC;AACnF,MAAIC,CAAC,GAAGC,SAAS,CAACC,MAAlB;AAAA,MAA0BC,CAAC,GAAGH,CAAC,GAAG,CAAJ,GAAQH,MAAR,GAAiBE,IAAI,KAAK,IAAT,GAAgBA,IAAI,GAAGd,MAAM,CAACmB,wBAAP,CAAgCP,MAAhC,EAAwCC,GAAxC,CAAvB,GAAsEC,IAArH;AAAA,MAA2HhB,CAA3H;AACA,MAAI,OAAOsB,OAAP,KAAmB,QAAnB,IAA+B,OAAOA,OAAO,CAACC,QAAf,KAA4B,UAA/D,EAA2EH,CAAC,GAAGE,OAAO,CAACC,QAAR,CAAiBV,UAAjB,EAA6BC,MAA7B,EAAqCC,GAArC,EAA0CC,IAA1C,CAAJ,CAA3E,KACK,KAAK,IAAIQ,CAAC,GAAGX,UAAU,CAACM,MAAX,GAAoB,CAAjC,EAAoCK,CAAC,IAAI,CAAzC,EAA4CA,CAAC,EAA7C,EAAiD,IAAIxB,CAAC,GAAGa,UAAU,CAACW,CAAD,CAAlB,EAAuBJ,CAAC,GAAG,CAACH,CAAC,GAAG,CAAJ,GAAQjB,CAAC,CAACoB,CAAD,CAAT,GAAeH,CAAC,GAAG,CAAJ,GAAQjB,CAAC,CAACc,MAAD,EAASC,GAAT,EAAcK,CAAd,CAAT,GAA4BpB,CAAC,CAACc,MAAD,EAASC,GAAT,CAA7C,KAA+DK,CAAnE;AAC7E,SAAOH,CAAC,GAAG,CAAJ,IAASG,CAAT,IAAclB,MAAM,CAACuB,cAAP,CAAsBX,MAAtB,EAA8BC,GAA9B,EAAmCK,CAAnC,CAAd,EAAqDA,CAA5D;AACH,CALD;;AAMA,IAAIM,cAAc,GAAI,QAAQ,KAAKA,cAAd,IAAiC,YAAY;AAC9D,OAAK,IAAIC,CAAC,GAAG,CAAR,EAAWH,CAAC,GAAG,CAAf,EAAkBI,EAAE,GAAGV,SAAS,CAACC,MAAtC,EAA8CK,CAAC,GAAGI,EAAlD,EAAsDJ,CAAC,EAAvD,EAA2DG,CAAC,IAAIT,SAAS,CAACM,CAAD,CAAT,CAAaL,MAAlB;;AAC3D,OAAK,IAAIC,CAAC,GAAGf,KAAK,CAACsB,CAAD,CAAb,EAAkBE,CAAC,GAAG,CAAtB,EAAyBL,CAAC,GAAG,CAAlC,EAAqCA,CAAC,GAAGI,EAAzC,EAA6CJ,CAAC,EAA9C,EACI,KAAK,IAAIM,CAAC,GAAGZ,SAAS,CAACM,CAAD,CAAjB,EAAsBO,CAAC,GAAG,CAA1B,EAA6BC,EAAE,GAAGF,CAAC,CAACX,MAAzC,EAAiDY,CAAC,GAAGC,EAArD,EAAyDD,CAAC,IAAIF,CAAC,EAA/D,EACIT,CAAC,CAACS,CAAD,CAAD,GAAOC,CAAC,CAACC,CAAD,CAAR;;AACR,SAAOX,CAAP;AACH,CAND;;AAOA,SAASa,KAAT,QAAsB,sBAAtB;AACA,SAASC,SAAT,QAA0B,0BAA1B;AACA,SAASC,IAAT,QAAqB,2BAArB;AACA,SAASC,IAAT,QAAqB,2BAArB;AACA,SAASC,KAAT,QAAsB,aAAtB;AACA,SAASC,aAAT,QAA8B,qBAA9B;AACA,SAASC,eAAT,QAAgC,mBAAhC;AACA,SAASC,kBAAT,QAAmC,iBAAnC;AACA,SAASC,aAAT,QAA8B,aAA9B;AACA,SAASC,aAAT,EAAwBC,YAAxB,QAA4C,qBAA5C;AACA,SAASC,OAAT,QAAwB,sBAAxB;AACA,SAASC,QAAT,QAAyB,0BAAzB;AACA,OAAOC,KAAP,IAAgBC,QAAhB,QAAgC,qBAAhC;AACA,IAAIC,sBAAJ;;AACA,CAAC,UAAUA,sBAAV,EAAkC;AAC/BA,EAAAA,sBAAsB,CAACA,sBAAsB,CAAC,KAAD,CAAtB,GAAgC,CAAjC,CAAtB,GAA4D,KAA5D;AACAA,EAAAA,sBAAsB,CAACA,sBAAsB,CAAC,OAAD,CAAtB,GAAkC,CAAnC,CAAtB,GAA8D,OAA9D;AACH,CAHD,EAGGA,sBAAsB,KAAKA,sBAAsB,GAAG,EAA9B,CAHzB;;AAIA,IAAIC,oBAAoB;AAAG;AAAe,UAAUC,MAAV,EAAkB;AACxDpD,EAAAA,SAAS,CAACmD,oBAAD,EAAuBC,MAAvB,CAAT;;AACA,WAASD,oBAAT,GAAgC;AAC5B,WAAOC,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACC,KAAP,CAAa,IAAb,EAAmBjC,SAAnB,CAAnB,IAAoD,IAA3D;AACH;;AACDN,EAAAA,UAAU,CAAC,CACPiC,QAAQ,CAAC,QAAD,CADD,CAAD,EAEPI,oBAAoB,CAACvC,SAFd,EAEyB,WAFzB,EAEsC,KAAK,CAF3C,CAAV;;AAGA,SAAOuC,oBAAP;AACH,CATyC,CASxCZ,KATwC,CAA1C;;AAUA,IAAIe,eAAe,GAAG,EAAtB;AACA,IAAIC,oBAAoB,GAAG;AACvBC,EAAAA,KAAK,EAAE,UAAUC,GAAV,EAAe;AAAE,WAAOA,GAAG,CAACC,IAAJ,CAASrC,MAAhB;AAAyB,GAD1B;AAEvBsC,EAAAA,GAAG,EAAE,UAAUF,GAAV,EAAeG,IAAf,EAAqB;AAAE,WAAOH,GAAG,CAACC,IAAJ,CAASG,MAAT,CAAgB,UAAUC,GAAV,EAAeC,KAAf,EAAsB;AAAE,aAAOD,GAAG,GAAGC,KAAK,CAACH,IAAD,CAAlB;AAA2B,KAAnE,EAAqE,CAArE,CAAP;AAAiF,GAFtF;AAGvBI,EAAAA,IAAI,EAAE,UAAUP,GAAV,EAAeG,IAAf,EAAqB;AAAE,WAAOL,oBAAoB,CAACI,GAArB,CAAyBF,GAAzB,EAA8BG,IAA9B,IAAsCL,oBAAoB,CAACC,KAArB,CAA2BC,GAA3B,EAAgCG,IAAhC,CAA7C;AAAqF;AAH3F,CAA3B;;AAKA,IAAIK,YAAY;AAAG;AAAe,YAAY;AAC1C,WAASA,YAAT,CAAsBC,EAAtB,EAA0B;AACtB,QAAIC,SAAS,GAAGD,EAAE,CAAC,CAAD,CAAlB;AAAA,QAAuBE,SAAS,GAAGF,EAAE,CAAC,CAAD,CAArC;AACA,SAAKR,IAAL,GAAY,EAAZ;AACA,SAAKW,eAAL,GAAuB,CAAvB;AACA,SAAKC,SAAL,GAAiB,CAAjB;AACA,SAAKC,MAAL,GAAc,CAACJ,SAAD,EAAYC,SAAZ,CAAd;AACH;;AACD;;AACAH,EAAAA,YAAY,CAACrD,SAAb,CAAuB4D,QAAvB,GAAkC,UAAUT,KAAV,EAAiB;AAC/C,SAAKL,IAAL,CAAUe,IAAV,CAAeV,KAAf;AACA,SAAKO,SAAL;AACH,GAHD;;AAIA;AACAlE,EAAAA,MAAM,CAACuB,cAAP,CAAsBsC,YAAY,CAACrD,SAAnC,EAA8C,aAA9C,EAA6D;AACzD8D,IAAAA,GAAG,EAAE,YAAY;AACb,UAAIR,EAAE,GAAG,KAAKK,MAAd;AAAA,UAAsBJ,SAAS,GAAGD,EAAE,CAAC,CAAD,CAApC;AAAA,UAAyCE,SAAS,GAAGF,EAAE,CAAC,CAAD,CAAvD;AACA,aAAOE,SAAS,GAAGD,SAAnB;AACH,KAJwD;AAKzDQ,IAAAA,UAAU,EAAE,IAL6C;AAMzDC,IAAAA,YAAY,EAAE;AAN2C,GAA7D;AAQAxE,EAAAA,MAAM,CAACuB,cAAP,CAAsBsC,YAAY,CAACrD,SAAnC,EAA8C,gBAA9C,EAAgE;AAC5D8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAKL,eAAL,GAAuB,KAAKQ,WAAnC;AACH,KAH2D;AAI5DF,IAAAA,UAAU,EAAE,IAJgD;AAK5DC,IAAAA,YAAY,EAAE;AAL8C,GAAhE;AAOA;;AACAX,EAAAA,YAAY,CAACrD,SAAb,CAAuBkE,wBAAvB,GAAkD,UAAUC,eAAV,EAA2BnB,IAA3B,EAAiC;AAC/E,QAAI,CAACA,IAAL,EAAW;AACP;AACAmB,MAAAA,eAAe,GAAG,OAAlB;AACH;;AACD,QAAIC,mBAAmB,GAAGzB,oBAAoB,CAACwB,eAAD,CAA9C;AACA,SAAKV,eAAL,GAAuBW,mBAAmB,CAAC,IAAD,EAAOpB,IAAP,CAA1C;AACH,GAPD;;AAQAK,EAAAA,YAAY,CAACrD,SAAb,CAAuBqE,IAAvB,GAA8B,UAAUC,QAAV,EAAoB;AAC9C,WAAOA,QAAQ,GAAG,KAAKC,cAAR,GAAyB,KAAKd,eAA7C;AACH,GAFD;;AAGA,SAAOJ,YAAP;AACH,CA1CiC,EAAlC;;AA2CA,SAASA,YAAT;AACA;;AACA,IAAImB,eAAe;AAAG;AAAe,UAAUhC,MAAV,EAAkB;AACnDpD,EAAAA,SAAS,CAACoF,eAAD,EAAkBhC,MAAlB,CAAT;;AACA,WAASgC,eAAT,GAA2B;AACvB,QAAIlB,EAAJ;;AACA,QAAImB,KAAK,GAAGjC,MAAM,CAACkC,IAAP,CAAY,IAAZ,KAAqB,IAAjC,CAFuB,CAGvB;AACA;AACA;AACA;;;AACAD,IAAAA,KAAK,CAACE,SAAN,GAAkBF,KAAK,CAACG,KAAN,CAAYC,WAAZ,CAAwB,IAAItD,KAAJ,EAAxB,CAAlB;AACAkD,IAAAA,KAAK,CAACK,SAAN,GAAkBL,KAAK,CAACG,KAAN,CAAYC,WAAZ,CAAwB,IAAItD,KAAJ,EAAxB,CAAlB;AACAkD,IAAAA,KAAK,CAACM,aAAN,GAAsBvD,SAAS,CAACwD,MAAV,CAAiBP,KAAK,CAACE,SAAvB,EAAkCM,SAAlC,EAAtB;AACAR,IAAAA,KAAK,CAACS,aAAN,GAAsB1D,SAAS,CAACwD,MAAV,CAAiBP,KAAK,CAACK,SAAvB,EAAkCG,SAAlC,EAAtB;AACAR,IAAAA,KAAK,CAACU,UAAN,GAAmB,EAAnB;AACAV,IAAAA,KAAK,CAACW,OAAN,GAAgB,EAAhB;AACAX,IAAAA,KAAK,CAACY,OAAN,GAAgB,EAAhB;AACAZ,IAAAA,KAAK,CAACa,KAAN,GAAc,IAAI/C,oBAAJ,EAAd;AACAkC,IAAAA,KAAK,CAACc,iBAAN,GAA0B,IAA1B;AACAd,IAAAA,KAAK,CAACe,IAAN,GAAaC,SAAb;AACAhB,IAAAA,KAAK,CAACiB,MAAN,GAAeD,SAAf;AACAhB,IAAAA,KAAK,CAACkB,WAAN,GAAoB,CAApB;AACAlB,IAAAA,KAAK,CAACmB,aAAN,GAAsB,CAAtB;AACAnB,IAAAA,KAAK,CAACoB,QAAN,GAAiBJ,SAAjB;AACAhB,IAAAA,KAAK,CAACqB,cAAN,GAAuB,CAAvB;AACArB,IAAAA,KAAK,CAACsB,aAAN,IAAuBzC,EAAE,GAAG,EAAL,EACnBA,EAAE,CAACxB,kBAAkB,CAACkE,CAApB,CAAF,GAA2B,CAAC,MAAD,CADR,EAEnB1C,EAAE,CAACxB,kBAAkB,CAACmE,CAApB,CAAF,GAA2B,CAAC,MAAD,CAFR,EAGnB3C,EAHJ;AAIAmB,IAAAA,KAAK,CAACyB,KAAN,GAAc,EAAd;AACAzB,IAAAA,KAAK,CAAC0B,SAAN,GAAkB,KAAlB;AACA1B,IAAAA,KAAK,CAAC2B,MAAN,GAAe,EAAf;AACA3B,IAAAA,KAAK,CAAC4B,KAAN,GAAc,EAAd;AACA5B,IAAAA,KAAK,CAAC6B,MAAN,GAAe,EAAf;AACA7B,IAAAA,KAAK,CAAC8B,YAAN,GAAqB,CAArB;AACA9B,IAAAA,KAAK,CAAC+B,cAAN,GAAuB;AAAEhB,MAAAA,IAAI,EAAE;AAAR,KAAvB;AACAf,IAAAA,KAAK,CAACa,KAAN,CAAYmB,OAAZ,GAAsB,KAAtB;;AACAhC,IAAAA,KAAK,CAACa,KAAN,CAAYoB,gBAAZ,CAA6B,QAA7B,EAAuCjC,KAAK,CAACkC,MAA7C,EAAqDlC,KAArD;;AACA,WAAOA,KAAP;AACH;;AACDD,EAAAA,eAAe,CAACxE,SAAhB,CAA0B4G,OAA1B,GAAoC,UAAUC,SAAV,EAAqB;AACrD,QAAIpC,KAAK,GAAG,IAAZ;;AACA,QAAIsB,aAAa,GAAG,KAAKA,aAAzB;AACA,QAAIe,IAAI,GAAGf,aAAa,IAAIA,aAAa,CAACc,SAAD,CAAzC;AACA,QAAIE,MAAM,GAAG,EAAb;;AACA,QAAID,IAAJ,EAAU;AACNA,MAAAA,IAAI,CAACE,OAAL,CAAa,UAAU3G,GAAV,EAAe;AACxB,YAAI4G,KAAK,GAAGxC,KAAK,CAACpE,GAAD,CAAjB;;AACA,YAAI4G,KAAJ,EAAW;AACP,cAAItH,KAAK,CAACuH,OAAN,CAAcD,KAAd,CAAJ,EAA0B;AACtBF,YAAAA,MAAM,CAAClD,IAAP,CAAYpB,KAAZ,CAAkBsE,MAAlB,EAA0BE,KAA1B;AACH,WAFD,MAGK;AACDF,YAAAA,MAAM,CAAClD,IAAP,CAAYoD,KAAZ;AACH;AACJ;AACJ,OAVD;AAWH;;AACD,WAAOF,MAAP;AACH,GAnBD;;AAoBAvH,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,MAAjD,EAAyD;AACrD8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAKoC,KAAZ;AACH,KAHoD;AAIrDiB,IAAAA,GAAG,EAAE,UAAUF,KAAV,EAAiB;AAClB,UAAI,KAAKf,KAAL,KAAee,KAAnB,EAA0B;AACtB,aAAKf,KAAL,GAAae,KAAb;AACA,aAAKG,YAAL;AACH;AACJ,KAToD;AAUrDrD,IAAAA,UAAU,EAAE,IAVyC;AAWrDC,IAAAA,YAAY,EAAE;AAXuC,GAAzD;AAaAxE,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,UAAjD,EAA6D;AACzD8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAKqC,SAAZ;AACH,KAHwD;AAIzDgB,IAAAA,GAAG,EAAE,UAAU5G,CAAV,EAAa;AACd,WAAK4F,SAAL,GAAiB5F,CAAjB;AACA,WAAK6G,YAAL;AACH,KAPwD;AAQzDrD,IAAAA,UAAU,EAAE,IAR6C;AASzDC,IAAAA,YAAY,EAAE;AAT2C,GAA7D;AAWAxE,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,MAAjD,EAAyD;AACrD8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAKuD,KAAZ;AACH,KAHoD;AAIrDF,IAAAA,GAAG,EAAE,UAAUG,IAAV,EAAgB;AACjB,WAAKD,KAAL,GAAaC,IAAb;AACA,WAAKF,YAAL;AACH,KAPoD;AAQrDrD,IAAAA,UAAU,EAAE,IARyC;AASrDC,IAAAA,YAAY,EAAE;AATuC,GAAzD;AAWAxE,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,aAAjD,EAAgE;AAC5D8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAKyD,YAAZ;AACH,KAH2D;AAI5DJ,IAAAA,GAAG,EAAE,UAAUK,WAAV,EAAuB;AACxB,WAAKD,YAAL,GAAoBC,WAApB;AACA,WAAKJ,YAAL;AACH,KAP2D;AAQ5DrD,IAAAA,UAAU,EAAE,IARgD;AAS5DC,IAAAA,YAAY,EAAE;AAT8C,GAAhE;AAWAxE,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,UAAjD,EAA6D;AACzD8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAK2D,SAAZ;AACH,KAHwD;AAIzDN,IAAAA,GAAG,EAAE,UAAUO,QAAV,EAAoB;AACrB,WAAKD,SAAL,GAAiBC,QAAjB;AACA,WAAKN,YAAL;AACH,KAPwD;AAQzDrD,IAAAA,UAAU,EAAE,IAR6C;AASzDC,IAAAA,YAAY,EAAE;AAT2C,GAA7D;AAWAxE,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,OAAjD,EAA0D;AACtD8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAKsC,MAAZ;AACH,KAHqD;AAItDe,IAAAA,GAAG,EAAE,UAAUF,KAAV,EAAiB;AAClB,UAAI,KAAKb,MAAL,KAAgBa,KAApB,EAA2B;AACvB,aAAKb,MAAL,GAAca,KAAd;AACA,aAAKN,MAAL;AACH;AACJ,KATqD;AAUtD5C,IAAAA,UAAU,EAAE,IAV0C;AAWtDC,IAAAA,YAAY,EAAE;AAXwC,GAA1D;AAaAxE,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,MAAjD,EAAyD;AACrD8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAKuC,KAAZ;AACH,KAHoD;AAIrDc,IAAAA,GAAG,EAAE,UAAUnE,IAAV,EAAgB;AACjB,WAAKqD,KAAL,GAAarD,IAAb;AACA,WAAKuC,iBAAL,GAAyB,IAAzB;AACA,WAAK6B,YAAL;AACH,KARoD;AASrDrD,IAAAA,UAAU,EAAE,IATyC;AAUrDC,IAAAA,YAAY,EAAE;AAVuC,GAAzD;AAYAxE,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,OAAjD,EAA0D;AACtD8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAKwC,MAAZ;AACH,KAHqD;AAItDa,IAAAA,GAAG,EAAE,UAAUJ,MAAV,EAAkB;AACnB,WAAKT,MAAL,GAAcS,MAAd;AACA,WAAKK,YAAL;AACH,KAPqD;AAQtDrD,IAAAA,UAAU,EAAE,IAR0C;AAStDC,IAAAA,YAAY,EAAE;AATwC,GAA1D;AAWAxE,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,aAAjD,EAAgE;AAC5D8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAKyC,YAAZ;AACH,KAH2D;AAI5DY,IAAAA,GAAG,EAAE,UAAUF,KAAV,EAAiB;AAClB,UAAI,KAAKV,YAAL,KAAsBU,KAA1B,EAAiC;AAC7B,aAAKV,YAAL,GAAoBU,KAApB;AACA,aAAKN,MAAL;AACH;AACJ,KAT2D;AAU5D5C,IAAAA,UAAU,EAAE,IAVgD;AAW5DC,IAAAA,YAAY,EAAE;AAX8C,GAAhE;AAaAxE,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,QAAjD,EAA2D;AACvD8D,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO,KAAK6D,OAAZ;AACH,KAHsD;AAIvDR,IAAAA,GAAG,EAAE,UAAUF,KAAV,EAAiB;AAClB,UAAI,KAAKU,OAAL,KAAiBV,KAArB,EAA4B;AACxB,aAAKU,OAAL,GAAeV,KAAf;AACA,aAAKN,MAAL;AACH;AACJ,KATsD;AAUvD5C,IAAAA,UAAU,EAAE,IAV2C;AAWvDC,IAAAA,YAAY,EAAE;AAXyC,GAA3D;;AAaAQ,EAAAA,eAAe,CAACxE,SAAhB,CAA0B4H,iBAA1B,GAA8C,YAAY;AACtD,SAAKC,eAAL;AACH,GAFD;;AAGArD,EAAAA,eAAe,CAACxE,SAAhB,CAA0B8H,SAA1B,GAAsC,UAAUC,KAAV,EAAiBC,OAAjB,EAA0B;AAC5D,SAAKxC,IAAL,GAAYuC,KAAK,CAAC,CAAD,CAAjB;AACA,SAAKrC,MAAL,GAAcsC,OAAO,CAAC,CAAD,CAArB;AACH,GAHD;AAIA;;;;AAEAxD,EAAAA,eAAe,CAACxE,SAAhB,CAA0BiI,UAA1B,GAAuC,YAAY;AAC/C,QAAIxD,KAAK,GAAG,IAAZ;;AACA,QAAInB,EAAE,GAAG,IAAT;AAAA,QAAegE,IAAI,GAAGhE,EAAE,CAACgE,IAAzB;AAAA,QAA+BI,QAAQ,GAAGpE,EAAE,CAACoE,QAA7C;;AACA,QAAI,CAAC,KAAK5E,IAAV,EAAgB;AACZ,aAAO,EAAP;AACH;;AACD,QAAIwE,IAAI,IAAII,QAAZ,EAAsB;AAClBQ,MAAAA,OAAO,CAACC,IAAR,CAAa,mFAAb;AACH;;AACD,QAAIb,IAAJ,EAAU;AACN;AACA,aAAOA,IAAP;AACH;;AACD,QAAIc,KAAK,GAAG,KAAKtF,IAAL,CAAUuF,GAAV,CAAc,UAAUlF,KAAV,EAAiB;AAAE,aAAOA,KAAK,CAACsB,KAAK,CAAC6D,IAAP,CAAZ;AAA2B,KAA5D,CAAZ;AACA,QAAIlD,OAAO,GAAG,KAAKmD,gBAAL,CAAsBtG,YAAY,CAACmG,KAAD,CAAlC,EAA2C,GAA3C,CAAd;AACA,QAAII,SAAS,GAAGpG,KAAK,CAACgD,OAAO,CAAC,CAAD,CAAR,EAAaA,OAAO,CAAC,CAAD,CAApB,EAAyB,KAAKsC,QAAL,IAAiBhF,eAA1C,CAArB;AACA,QAAI+F,OAAO,GAAGpG,QAAQ,CAAC+C,OAAO,CAAC,CAAD,CAAR,EAAaA,OAAO,CAAC,CAAD,CAApB,EAAyB,KAAKsC,QAAL,IAAiBhF,eAA1C,CAAtB;AACA,QAAIgG,WAAW,GAAGF,SAAS,CAAC,CAAD,CAA3B;;AACA,QAAIG,gBAAgB,GAAG,UAAUC,CAAV,EAAa;AAAE,aAAO,CAACA,CAAD,EAAIA,CAAC,GAAGH,OAAR,CAAP;AAA0B,KAAhE;;AACA,WAAOzH,cAAc,CAAC,CAClB,CAAC0H,WAAW,GAAGD,OAAf,EAAwBC,WAAxB,CADkB,CAAD,EAElBF,SAAS,CAACH,GAAV,CAAcM,gBAAd,CAFkB,CAArB;AAGH,GAtBD;;AAuBAnE,EAAAA,eAAe,CAACxE,SAAhB,CAA0B6I,eAA1B,GAA4C,UAAU/F,IAAV,EAAgB;AACxD,QAAI2B,KAAK,GAAG,IAAZ;;AACA,QAAI6D,IAAI,GAAG,KAAKA,IAAhB;AACA,QAAIQ,WAAW,GAAG,KAAKb,UAAL,EAAlB,CAHwD,CAIxD;AACA;;AACA,QAAIc,UAAU,GAAGjG,IAAI,CAACkG,KAAL,GAAaC,IAAb,CAAkB,UAAU7H,CAAV,EAAa7B,CAAb,EAAgB;AAC/C,UAAI6B,CAAC,CAACkH,IAAD,CAAD,GAAU/I,CAAC,CAAC+I,IAAD,CAAf,EAAuB;AACnB,eAAO,CAAC,CAAR;AACH;;AACD,UAAIlH,CAAC,CAACkH,IAAD,CAAD,GAAU/I,CAAC,CAAC+I,IAAD,CAAf,EAAuB;AACnB,eAAO,CAAP;AACH;;AACD,aAAO,CAAP;AACH,KARgB,CAAjB;AASA,QAAIY,UAAU,GAAG,CAAjB;AACA,QAAI5B,IAAI,GAAG,CAAC,IAAIjE,YAAJ,CAAiByF,WAAW,CAAC,CAAD,CAA5B,CAAD,CAAX;AACAC,IAAAA,UAAU,CAAC/B,OAAX,CAAmB,UAAU7D,KAAV,EAAiB;AAChC,aAAOA,KAAK,CAACmF,IAAD,CAAL,GAAcQ,WAAW,CAACI,UAAD,CAAX,CAAwB,CAAxB,CAArB,EAAiD;AAC7CA,QAAAA,UAAU;AACV5B,QAAAA,IAAI,CAACzD,IAAL,CAAU,IAAIR,YAAJ,CAAiByF,WAAW,CAACI,UAAD,CAA5B,CAAV;AACH;;AACD5B,MAAAA,IAAI,CAAC4B,UAAD,CAAJ,CAAiBtF,QAAjB,CAA0BT,KAA1B;AACH,KAND;AAOAmE,IAAAA,IAAI,CAACN,OAAL,CAAa,UAAUzH,CAAV,EAAa;AAAE,aAAOA,CAAC,CAAC2E,wBAAF,CAA2BO,KAAK,CAAC8C,YAAjC,EAA+C9C,KAAK,CAACzB,IAArD,CAAP;AAAoE,KAAhG;AACA,WAAOsE,IAAP;AACH,GA1BD;;AA2BA9H,EAAAA,MAAM,CAACuB,cAAP,CAAsByD,eAAe,CAACxE,SAAtC,EAAiD,MAAjD,EAAyD;AACrD8D,IAAAA,GAAG,EAAE,YAAY;AACb,UAAIW,KAAK,GAAG,IAAZ;;AACA,aAAO,KAAK3B,IAAL,IAAa,KAAKA,IAAL,CAAUG,MAAV,CAAiB,UAAUC,GAAV,EAAeC,KAAf,EAAsB;AACvD,eAAOgG,IAAI,CAACC,GAAL,CAASlG,GAAT,EAAcC,KAAK,CAACsB,KAAK,CAAC6D,IAAP,CAAnB,CAAP;AACH,OAFmB,EAEjBe,MAAM,CAACC,iBAFU,CAApB;AAGH,KANoD;AAOrDvF,IAAAA,UAAU,EAAE,IAPyC;AAQrDC,IAAAA,YAAY,EAAE;AARuC,GAAzD;;AAUAQ,EAAAA,eAAe,CAACxE,SAAhB,CAA0BuJ,WAA1B,GAAwC,YAAY;AAChD,QAAI9E,KAAK,GAAG,IAAZ;;AACA,QAAInB,EAAE,GAAG,IAAT;AAAA,QAAegF,IAAI,GAAGhF,EAAE,CAACgF,IAAzB;AAAA,QAA+BxF,IAAI,GAAGQ,EAAE,CAACR,IAAzC;;AACA,SAAKqC,UAAL,GAAkB,KAAK0D,eAAL,CAAqBP,IAAI,IAAIxF,IAAR,GAAeA,IAAf,GAAsB,EAA3C,CAAlB;AACA,QAAI0G,KAAK,GAAG,KAAKrE,UAAL,CAAgBkD,GAAhB,CAAoB,UAAU9I,CAAV,EAAa;AAAE,aAAOA,CAAC,CAAC8E,IAAF,CAAOI,KAAK,CAACH,QAAb,CAAP;AAAgC,KAAnE,CAAZ;AACA,QAAImF,OAAO,GAAGzH,aAAa,CAACwH,KAAD,CAA3B;AACA,SAAKnE,OAAL,GAAe,KAAKkD,gBAAL,CAAsB,CAAC,CAAD,EAAIkB,OAAO,GAAGA,OAAO,CAAC,CAAD,CAAV,GAAgB,CAA3B,CAAtB,EAAqD,GAArD,CAAf;AACA,QAAIC,QAAQ,GAAG,KAAKvE,UAAL,CAAgB,CAAhB,CAAf;AACA,QAAIwE,OAAO,GAAG,KAAKxE,UAAL,CAAgB,KAAKA,UAAL,CAAgB1E,MAAhB,GAAyB,CAAzC,CAAd;AACA,QAAImJ,IAAI,GAAGF,QAAQ,CAAC/F,MAAT,CAAgB,CAAhB,CAAX;AACA,QAAIkG,IAAI,GAAGF,OAAO,CAAChG,MAAR,CAAe,CAAf,CAAX;AACA,SAAKyB,OAAL,GAAe,CAACwE,IAAD,EAAOC,IAAP,CAAf;AACA,SAAKC,SAAL,CAAe;AAAEC,MAAAA,IAAI,EAAE;AAAR,KAAf;AACA,WAAO,IAAP;AACH,GAdD;;AAeAvF,EAAAA,eAAe,CAACxE,SAAhB,CAA0BgK,SAA1B,GAAsC,UAAUnD,SAAV,EAAqB;AACvD,QAAIA,SAAS,KAAK/E,kBAAkB,CAACkE,CAArC,EAAwC;AACpC,aAAO,KAAKZ,OAAZ;AACH,KAFD,MAGK;AACD,aAAO,KAAKC,OAAZ;AACH;AACJ,GAPD;;AAQAb,EAAAA,eAAe,CAACxE,SAAhB,CAA0BiK,kBAA1B,GAA+C,UAAU9G,KAAV,EAAiB;AAC5D,SAAK2G,SAAL,CAAe;AACXC,MAAAA,IAAI,EAAE,WADK;AAEXG,MAAAA,MAAM,EAAE,IAFG;AAGX/G,MAAAA,KAAK,EAAEA,KAAK,CAACgH,WAHF;AAIX7B,MAAAA,IAAI,EAAE,KAAKA;AAJA,KAAf;AAMH,GAPD;;AAQA9D,EAAAA,eAAe,CAACxE,SAAhB,CAA0B2G,MAA1B,GAAmC,YAAY;AAC3C,QAAIrD,EAAE,GAAG,IAAT;AAAA,QAAe8G,OAAO,GAAG9G,EAAE,CAAC8G,OAA5B;AAAA,QAAqCC,KAAK,GAAG/G,EAAE,CAAC+G,KAAhD;AAAA,QAAuDC,KAAK,GAAGhH,EAAE,CAACgH,KAAlE;AAAA,QAAyEC,KAAK,GAAGjH,EAAE,CAACiH,KAApF;;AACA,SAAK3F,KAAL,CAAWwF,OAAX,GAAqBA,OAArB;;AACA,QAAI,CAACE,KAAD,IAAU,CAACC,KAAX,IAAoB,CAACH,OAArB,IAAgC,CAACC,KAAjC,IAA0CA,KAAK,CAACG,aAAhD,IAAiEH,KAAK,CAACI,WAA3E,EAAwF;AACpF;AACH;;AACD,QAAIC,QAAQ,GAAG,KAAKC,gBAAL,EAAf;AACA,SAAKC,mBAAL,CAAyBF,QAAzB;AACA,SAAK7C,eAAL;AACA,SAAKgD,mBAAL,CAAyBH,QAAzB;AACA,SAAKI,eAAL;AACH,GAXD;;AAYAtG,EAAAA,eAAe,CAACxE,SAAhB,CAA0B2K,gBAA1B,GAA6C,YAAY;AACrD,QAAIlG,KAAK,GAAG,IAAZ;;AACA,QAAI,CAAC,KAAKc,iBAAV,EAA6B;AACzB,aAAO,EAAP;AACH;;AACD,QAAIjC,EAAE,GAAG,IAAT;AAAA,QAAeyH,MAAM,GAAGzH,EAAE,CAACgH,KAAH,CAASU,KAAjC;AAAA,QAAwCC,MAAM,GAAG3H,EAAE,CAACiH,KAAH,CAASS,KAA1D;AAAA,QAAiExF,IAAI,GAAGlC,EAAE,CAACkC,IAA3E;AAAA,QAAiFE,MAAM,GAAGpC,EAAE,CAACoC,MAA7F;AAAA,QAAqGwF,WAAW,GAAG5H,EAAE,CAAC4H,WAAtH;;AACA,QAAIR,QAAQ,GAAG,EAAf;;AACA,QAAIS,qBAAqB,GAAG,UAAUC,MAAV,EAAkB;AAAE,aAAOC,MAAM,CAACD,MAAM,CAACnE,KAAR,CAAb;AAA8B,KAA9E;;AACA,QAAIqE,EAAE,GAAG,KAAKhG,KAAd;AAAA,QAAqBiG,EAAE,GAAGD,EAAE,CAACE,SAA7B;AAAA,QAAwCC,cAAc,GAAGF,EAAE,KAAK,KAAK,CAAZ,GAAgBJ,qBAAhB,GAAwCI,EAAjG;AAAA,QAAqGG,cAAc,GAAGJ,EAAE,CAACK,SAAzH;AAAA,QAAoIC,eAAe,GAAGN,EAAE,CAACO,UAAzJ;AAAA,QAAqKC,aAAa,GAAGR,EAAE,CAACS,QAAxL;AAAA,QAAkMC,eAAe,GAAGV,EAAE,CAACW,UAAvN;AAAA,QAAmOC,UAAU,GAAGZ,EAAE,CAACa,KAAnP;AACA,SAAKhH,UAAL,CAAgB6B,OAAhB,CAAwB,UAAUoF,SAAV,EAAqB;AACzC,UAAIC,KAAK,GAAGD,SAAS,CAAC3I,eAAtB;AAAA,UAAuCC,SAAS,GAAG0I,SAAS,CAAC1I,SAA7D;AAAA,UAAwEJ,EAAE,GAAG8I,SAAS,CAACzI,MAAvF;AAAA,UAA+F2I,UAAU,GAAGhJ,EAAE,CAAC,CAAD,CAA9G;AAAA,UAAmHiJ,UAAU,GAAGjJ,EAAE,CAAC,CAAD,CAAlI;AAAA,UAAuIiB,cAAc,GAAG6H,SAAS,CAAC7H,cAAlK;AACA,UAAIiI,MAAM,GAAGzB,MAAM,CAAC0B,OAAP,CAAeH,UAAf,CAAb;AAAA,UAAyCI,MAAM,GAAG3B,MAAM,CAAC0B,OAAP,CAAeF,UAAf,CAAlD;AAAA,UACA;AACAI,MAAAA,CAAC,GAAGlI,KAAK,CAACH,QAAN,GAAiBC,cAAjB,GAAmCE,KAAK,CAACzB,IAAN,GAAaqJ,KAAb,GAAqB3I,SAF5D;AAAA,UAEwEkJ,OAAO,GAAG3B,MAAM,CAACwB,OAAP,CAAe,CAAf,CAFlF;AAAA,UAEqGI,MAAM,GAAG5B,MAAM,CAACwB,OAAP,CAAeE,CAAf,CAF9G;AAAA,UAEiIG,CAAC,GAAGJ,MAAM,GAAGF,MAF9I;AAAA,UAEsJO,CAAC,GAAG5D,IAAI,CAAC6D,GAAL,CAASH,MAAM,GAAGD,OAAlB,CAF1J;AAGA,UAAIK,mBAAmB,GAAGN,CAAC,KAAK,CAAN,GAAU;AAChCO,QAAAA,IAAI,EAAEzB,cAAc,CAAC;AAAExE,UAAAA,KAAK,EAAEmF,SAAS,CAAC3I;AAAnB,SAAD,CADY;AAEhCkI,QAAAA,SAAS,EAAED,cAFqB;AAGhCG,QAAAA,UAAU,EAAED,eAHoB;AAIhCG,QAAAA,QAAQ,EAAED,aAJsB;AAKhCG,QAAAA,UAAU,EAAED,eALoB;AAMhCxG,QAAAA,IAAI,EAAE0G,UAN0B;AAOhCiB,QAAAA,CAAC,EAAEX,MAAM,GAAGM,CAAC,GAAG,CAPgB;AAQhCH,QAAAA,CAAC,EAAEE,MAAM,GAAGE,CAAC,GAAG;AARgB,OAAV,GAStBtH,SATJ;AAUAiF,MAAAA,QAAQ,CAAC7G,IAAT,CAAc;AACVqG,QAAAA,MAAM,EAAEzF,KADE;AAEV0F,QAAAA,WAAW,EAAEiC,SAFH;AAGV;AACAe,QAAAA,CAAC,EAAEX,MAJO;AAKVG,QAAAA,CAAC,EAAEE,MALO;AAMVO,QAAAA,KAAK,EAAEN,CANG;AAOVO,QAAAA,MAAM,EAAEN,CAPE;AAQVvH,QAAAA,IAAI,EAAEA,IARI;AASVE,QAAAA,MAAM,EAAEA,MATE;AAUVwF,QAAAA,WAAW,EAAEA,WAVH;AAWV5F,QAAAA,KAAK,EAAE2H;AAXG,OAAd;AAaH,KA5BD;AA6BA,WAAOvC,QAAP;AACH,GAvCD;;AAwCAlG,EAAAA,eAAe,CAACxE,SAAhB,CAA0B4K,mBAA1B,GAAgD,UAAUF,QAAV,EAAoB;AAChE,QAAI4C,WAAW,GAAG,KAAKvI,aAAL,CAAmBwI,OAAnB,CAA2B7C,QAA3B,CAAlB;AACA4C,IAAAA,WAAW,CAACE,IAAZ,CAAiBC,MAAjB;AACA,QAAIC,UAAU,GAAGJ,WAAW,CAACK,KAAZ,CAAkBC,MAAlB,CAAyBnM,IAAzB,EAA+BoM,IAA/B,CAAoC,UAAUC,IAAV,EAAgB;AACjEA,MAAAA,IAAI,CAACC,GAAL,GAAWzL,sBAAsB,CAAC0L,GAAlC;AACAF,MAAAA,IAAI,CAACG,KAAL,GAAa,IAAb;AACH,KAHgB,CAAjB;AAIA,SAAKlJ,aAAL,GAAqBuI,WAAW,CAACY,KAAZ,CAAkBR,UAAlB,CAArB;AACH,GARD;;AASAlJ,EAAAA,eAAe,CAACxE,SAAhB,CAA0B6H,eAA1B,GAA4C,YAAY;AACpD,QAAIpD,KAAK,GAAG,IAAZ;;AACA,QAAI,CAAC,KAAK4F,KAAV,EAAiB;AACb;AACH;;AACD,QAAI8D,gBAAgB,GAAG,KAAK9D,KAAL,CAAW8D,gBAAlC;;AACA,QAAI7K,EAAE,GAAG,IAAT;AAAA,QAAeqC,WAAW,GAAGrC,EAAE,CAACqC,WAAhC;AAAA,QAA6CC,aAAa,GAAGtC,EAAE,CAACsC,aAAhE;AAAA,QAA+EwI,MAAM,GAAG9K,EAAE,CAAC8K,MAA3F;AAAA,QAAmG9C,EAAE,GAAGhI,EAAE,CAACkD,cAA3G;AAAA,QAA2HhB,IAAI,GAAG8F,EAAE,CAAC9F,IAArI;AAAA,QAA2IE,MAAM,GAAG4F,EAAE,CAAC5F,MAAvJ;;AACA,SAAKX,aAAL,CAAmB8I,IAAnB,CAAwB,UAAUC,IAAV,EAAgB3K,KAAhB,EAAuB;AAC3C,UAAIkL,WAAW,GAAGlL,KAAK,KAAKgL,gBAA5B;AACAL,MAAAA,IAAI,CAACX,CAAL,GAAShK,KAAK,CAACgK,CAAf;AACAW,MAAAA,IAAI,CAACnB,CAAL,GAASxJ,KAAK,CAACwJ,CAAf;AACAmB,MAAAA,IAAI,CAACV,KAAL,GAAajK,KAAK,CAACiK,KAAnB;AACAU,MAAAA,IAAI,CAACT,MAAL,GAAclK,KAAK,CAACkK,MAApB;AACAS,MAAAA,IAAI,CAACtI,IAAL,GAAY6I,WAAW,IAAI7I,IAAI,KAAKC,SAAxB,GAAoCD,IAApC,GAA2CrC,KAAK,CAACqC,IAA7D;AACAsI,MAAAA,IAAI,CAACpI,MAAL,GAAc2I,WAAW,IAAI3I,MAAM,KAAKD,SAA1B,GAAsCC,MAAtC,GAA+CvC,KAAK,CAACuC,MAAnE;AACAoI,MAAAA,IAAI,CAACnI,WAAL,GAAmBA,WAAnB;AACAmI,MAAAA,IAAI,CAAClI,aAAL,GAAqBA,aAArB;AACAkI,MAAAA,IAAI,CAAC5C,WAAL,GAAmB/H,KAAK,CAAC+H,WAAzB;AACA4C,MAAAA,IAAI,CAACjI,QAAL,GAAgBpB,KAAK,CAACoB,QAAtB;AACAiI,MAAAA,IAAI,CAAChI,cAAL,GAAsBrB,KAAK,CAACqB,cAA5B;AACAgI,MAAAA,IAAI,CAACQ,UAAL,GAAkBF,MAAlB;AACAN,MAAAA,IAAI,CAAC1D,OAAL,GAAejH,KAAK,CAACkK,MAAN,GAAe,CAA9B,CAd2C,CAcV;AACpC,KAfD;AAgBH,GAvBD;;AAwBA7I,EAAAA,eAAe,CAACxE,SAAhB,CAA0B6K,mBAA1B,GAAgD,UAAUH,QAAV,EAAoB;AAChE,QAAI6D,WAAW,GAAG,KAAKrJ,aAAL,CAAmBqI,OAAnB,CAA2B7C,QAA3B,CAAlB;AACA6D,IAAAA,WAAW,CAACf,IAAZ,CAAiBC,MAAjB;AACA,QAAIe,UAAU,GAAGD,WAAW,CAACZ,KAAZ,CAAkBC,MAAlB,CAAyBlM,IAAzB,EAA+BmM,IAA/B,CAAoC,UAAUX,IAAV,EAAgB;AACjEA,MAAAA,IAAI,CAACa,GAAL,GAAWzL,sBAAsB,CAACX,KAAlC;AACAuL,MAAAA,IAAI,CAACuB,aAAL,GAAqB7M,aAAa,CAAC8M,IAAnC;AACAxB,MAAAA,IAAI,CAACyB,SAAL,GAAiB,QAAjB;AACAzB,MAAAA,IAAI,CAAC0B,YAAL,GAAoB,QAApB;AACH,KALgB,CAAjB;AAMA,SAAK1J,aAAL,GAAqBqJ,WAAW,CAACL,KAAZ,CAAkBM,UAAlB,CAArB;AACH,GAVD;;AAWAhK,EAAAA,eAAe,CAACxE,SAAhB,CAA0B8K,eAA1B,GAA4C,YAAY;AACpD,QAAI+D,YAAY,GAAG,KAAKvJ,KAAL,CAAWmB,OAA9B;AACA,SAAKvB,aAAL,CAAmB2I,IAAnB,CAAwB,UAAUX,IAAV,EAAgB/J,KAAhB,EAAuB;AAC3C,UAAImC,KAAK,GAAGnC,KAAK,CAACmC,KAAlB;;AACA,UAAIA,KAAK,IAAIuJ,YAAb,EAA2B;AACvB3B,QAAAA,IAAI,CAACA,IAAL,GAAY5H,KAAK,CAAC4H,IAAlB;AACAA,QAAAA,IAAI,CAACC,CAAL,GAAS7H,KAAK,CAAC6H,CAAf;AACAD,QAAAA,IAAI,CAACP,CAAL,GAASrH,KAAK,CAACqH,CAAf;AACAO,QAAAA,IAAI,CAACvB,SAAL,GAAiBrG,KAAK,CAACqG,SAAvB;AACAuB,QAAAA,IAAI,CAACrB,UAAL,GAAkBvG,KAAK,CAACuG,UAAxB;AACAqB,QAAAA,IAAI,CAACnB,QAAL,GAAgBzG,KAAK,CAACyG,QAAtB;AACAmB,QAAAA,IAAI,CAACjB,UAAL,GAAkB3G,KAAK,CAAC2G,UAAxB;AACAiB,QAAAA,IAAI,CAAC1H,IAAL,GAAYF,KAAK,CAACE,IAAlB;AACA0H,QAAAA,IAAI,CAAC9C,OAAL,GAAe,IAAf;AACH,OAVD,MAWK;AACD8C,QAAAA,IAAI,CAAC9C,OAAL,GAAe,KAAf;AACH;AACJ,KAhBD;AAiBH,GAnBD;;AAoBA5F,EAAAA,eAAe,CAACxE,SAAhB,CAA0B8O,cAA1B,GAA2C,UAAUC,SAAV,EAAqB;AAC5D,QAAIzL,EAAE,GAAG,IAAT;AAAA,QAAegF,IAAI,GAAGhF,EAAE,CAACgF,IAAzB;AAAA,QAA+BtF,IAAI,GAAGM,EAAE,CAACN,IAAzC;;AACA,QAAI,CAACsF,IAAL,EAAW;AACP,aAAO,EAAP;AACH;;AACD,QAAIgD,EAAE,GAAG,IAAT;AAAA,QAAe0D,KAAK,GAAG1D,EAAE,CAAC0D,KAA1B;AAAA,QAAiCC,KAAK,GAAG3D,EAAE,CAAC2D,KAA5C;AAAA,QAAmD9C,KAAK,GAAGb,EAAE,CAAC9F,IAA9D;AAAA,QAAoE0J,eAAe,GAAG5D,EAAE,CAAC4D,eAAzF;AAAA,QAA0G1H,WAAW,GAAG8D,EAAE,CAAC9D,WAA3H;;AACA,QAAI3E,GAAG,GAAGkM,SAAS,CAAC5E,WAApB;AACA,QAAI1G,eAAe,GAAGZ,GAAG,CAACY,eAA1B;AAAA,QAA2CC,SAAS,GAAGb,GAAG,CAACa,SAA3D;AAAA,QAAsE6H,EAAE,GAAG1I,GAAG,CAACc,MAA/E;AAAA,QAAuFwL,QAAQ,GAAG5D,EAAE,CAAC,CAAD,CAApG;AAAA,QAAyG6D,QAAQ,GAAG7D,EAAE,CAAC,CAAD,CAAtH;AACA,QAAI8D,KAAK,GAAG,CAACL,KAAK,IAAI1G,IAAV,IAAkB,GAAlB,GAAwBpG,OAAO,CAACiN,QAAD,CAA/B,GAA4C,KAA5C,GAAoDjN,OAAO,CAACkN,QAAD,CAAvE;AACA,QAAIE,OAAO,GAAGtM,IAAI,GACd,SAASiM,KAAK,IAAIjM,IAAlB,IAA0B,IAA1B,GAAiCwE,WAAjC,GAA+C,SAA/C,GAA2DtF,OAAO,CAACuB,eAAD,CAAlE,GAAsF,MADxE,GAEd,EAFJ;AAGA6L,IAAAA,OAAO,IAAI,uBAAuB5L,SAAlC;AACA,QAAI6L,QAAQ,GAAG;AACXF,MAAAA,KAAK,EAAEA,KADI;AAEXG,MAAAA,oBAAoB,EAAErD,KAFX;AAGXmD,MAAAA,OAAO,EAAEA;AAHE,KAAf;;AAKA,QAAIJ,eAAJ,EAAqB;AACjB,aAAOnN,aAAa,CAACmN,eAAe,CAAC;AACjC/L,QAAAA,KAAK,EAAEN,GAD0B;AAEjCyF,QAAAA,IAAI,EAAEA,IAF2B;AAGjCmH,QAAAA,MAAM,EAAE5M,GAAG,CAACc,MAHqB;AAIjCqL,QAAAA,KAAK,EAAEA,KAJ0B;AAKjChM,QAAAA,IAAI,EAAEA,IAL2B;AAMjC0M,QAAAA,MAAM,EAAE7M,GAAG,CAACY,eANqB;AAOjCwL,QAAAA,KAAK,EAAEA,KAP0B;AAQjC9C,QAAAA,KAAK,EAAEA;AAR0B,OAAD,CAAhB,EAShBoD,QATgB,CAApB;AAUH;;AACD,WAAOxN,aAAa,CAACwN,QAAD,CAApB;AACH,GA/BD;;AAgCA/K,EAAAA,eAAe,CAACxE,SAAhB,CAA0B2P,eAA1B,GAA4C,UAAUC,UAAV,EAAsB;AAC9D,QAAItM,EAAE,GAAG,IAAT;AAAA,QAAeuM,EAAE,GAAGvM,EAAE,CAACuM,EAAvB;AAAA,QAA2B/M,IAAI,GAAGQ,EAAE,CAACR,IAArC;AAAA,QAA2CE,IAAI,GAAGM,EAAE,CAACN,IAArD;AAAA,QAA2DiM,KAAK,GAAG3L,EAAE,CAAC2L,KAAtE;AAAA,QAA6E1J,iBAAiB,GAAGjC,EAAE,CAACiC,iBAApG;AAAA,QAAuHC,IAAI,GAAGlC,EAAE,CAACkC,IAAjI;AAAA,QAAuIE,MAAM,GAAGpC,EAAE,CAACoC,MAAnJ;AAAA,QAA2JC,WAAW,GAAGrC,EAAE,CAACqC,WAA5K;AAAA,QAAyLC,aAAa,GAAGtC,EAAE,CAACsC,aAA5M;;AACA,QAAI9C,IAAI,IAAIA,IAAI,CAACrC,MAAjB,EAAyB;AACrBmP,MAAAA,UAAU,CAAC/L,IAAX,CAAgB;AACZgM,QAAAA,EAAE,EAAEA,EADQ;AAEZC,QAAAA,MAAM,EAAE9M,IAFI;AAGZyD,QAAAA,OAAO,EAAElB,iBAHG;AAIZD,QAAAA,KAAK,EAAE;AACH4H,UAAAA,IAAI,EAAE+B,KAAK,IAAIjM,IAAT,IAAiB;AADpB,SAJK;AAOZ+M,QAAAA,MAAM,EAAE;AACJvK,UAAAA,IAAI,EAAEA,IAAI,IAAI,kBADV;AAEJE,UAAAA,MAAM,EAAEA,MAAM,IAAI,kBAFd;AAGJC,UAAAA,WAAW,EAAEA,WAHT;AAIJC,UAAAA,aAAa,EAAEA;AAJX;AAPI,OAAhB;AAcH;AACJ,GAlBD;;AAmBApB,EAAAA,eAAe,CAACxE,SAAhB,CAA0BgQ,gBAA1B,GAA6C,UAAUF,MAAV,EAAkBrJ,OAAlB,EAA2B;AACpE,QAAIqJ,MAAM,KAAK,KAAK9M,IAApB,EAA0B;AACtB,WAAKuC,iBAAL,GAAyBkB,OAAzB;AACH;;AACD,SAAKW,YAAL;AACH,GALD;;AAMA5C,EAAAA,eAAe,CAACyL,SAAhB,GAA4B,iBAA5B;AACAzL,EAAAA,eAAe,CAACuF,IAAhB,GAAuB,WAAvB;;AACA7J,EAAAA,UAAU,CAAC,CACPiC,QAAQ,CAAC,YAAD,CADD,CAAD,EAEPqC,eAAe,CAACxE,SAFT,EAEoB,MAFpB,EAE4B,KAAK,CAFjC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPiC,QAAQ,CAAC,YAAD,CADD,CAAD,EAEPqC,eAAe,CAACxE,SAFT,EAEoB,QAFpB,EAE8B,KAAK,CAFnC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPiC,QAAQ,CAAC,cAAD,CADD,CAAD,EAEPqC,eAAe,CAACxE,SAFT,EAEoB,aAFpB,EAEmC,KAAK,CAFxC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPiC,QAAQ,CAAC,cAAD,CADD,CAAD,EAEPqC,eAAe,CAACxE,SAFT,EAEoB,eAFpB,EAEqC,KAAK,CAF1C,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPiC,QAAQ,CAAC,QAAD,CADD,CAAD,EAEPqC,eAAe,CAACxE,SAFT,EAEoB,UAFpB,EAEgC,KAAK,CAFrC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPiC,QAAQ,CAAC,QAAD,CADD,CAAD,EAEPqC,eAAe,CAACxE,SAFT,EAEoB,gBAFpB,EAEsC,KAAK,CAF3C,CAAV;;AAGA,SAAOwE,eAAP;AACH,CAxdoC,CAwdnC3C,eAxdmC,CAArC;;AAydA,SAAS2C,eAAT","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { Group } from \"../../../scene/group\";\nimport { Selection } from \"../../../scene/selection\";\nimport { Rect } from \"../../../scene/shape/rect\";\nimport { Text } from \"../../../scene/shape/text\";\nimport { Label } from \"../../label\";\nimport { PointerEvents } from \"../../../scene/node\";\nimport { CartesianSeries } from \"./cartesianSeries\";\nimport { ChartAxisDirection } from \"../../chartAxis\";\nimport { toTooltipHtml } from \"../../chart\";\nimport { numericExtent, finiteExtent } from \"../../../util/array\";\nimport { toFixed } from \"../../../util/number\";\nimport { reactive } from \"../../../util/observable\";\nimport ticks, { tickStep } from \"../../../util/ticks\";\nvar HistogramSeriesNodeTag;\n(function (HistogramSeriesNodeTag) {\n    HistogramSeriesNodeTag[HistogramSeriesNodeTag[\"Bin\"] = 0] = \"Bin\";\n    HistogramSeriesNodeTag[HistogramSeriesNodeTag[\"Label\"] = 1] = \"Label\";\n})(HistogramSeriesNodeTag || (HistogramSeriesNodeTag = {}));\nvar HistogramSeriesLabel = /** @class */ (function (_super) {\n    __extends(HistogramSeriesLabel, _super);\n    function HistogramSeriesLabel() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        reactive('change')\n    ], HistogramSeriesLabel.prototype, \"formatter\", void 0);\n    return HistogramSeriesLabel;\n}(Label));\nvar defaultBinCount = 10;\nvar aggregationFunctions = {\n    count: function (bin) { return bin.data.length; },\n    sum: function (bin, yKey) { return bin.data.reduce(function (acc, datum) { return acc + datum[yKey]; }, 0); },\n    mean: function (bin, yKey) { return aggregationFunctions.sum(bin, yKey) / aggregationFunctions.count(bin, yKey); }\n};\nvar HistogramBin = /** @class */ (function () {\n    function HistogramBin(_a) {\n        var domainMin = _a[0], domainMax = _a[1];\n        this.data = [];\n        this.aggregatedValue = 0;\n        this.frequency = 0;\n        this.domain = [domainMin, domainMax];\n    }\n    ;\n    HistogramBin.prototype.addDatum = function (datum) {\n        this.data.push(datum);\n        this.frequency++;\n    };\n    ;\n    Object.defineProperty(HistogramBin.prototype, \"domainWidth\", {\n        get: function () {\n            var _a = this.domain, domainMin = _a[0], domainMax = _a[1];\n            return domainMax - domainMin;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramBin.prototype, \"relativeHeight\", {\n        get: function () {\n            return this.aggregatedValue / this.domainWidth;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ;\n    HistogramBin.prototype.calculateAggregatedValue = function (aggregationName, yKey) {\n        if (!yKey) {\n            // not having a yKey forces us into a frequency plot\n            aggregationName = 'count';\n        }\n        var aggregationFunction = aggregationFunctions[aggregationName];\n        this.aggregatedValue = aggregationFunction(this, yKey);\n    };\n    HistogramBin.prototype.getY = function (areaPlot) {\n        return areaPlot ? this.relativeHeight : this.aggregatedValue;\n    };\n    return HistogramBin;\n}());\nexport { HistogramBin };\n;\nvar HistogramSeries = /** @class */ (function (_super) {\n    __extends(HistogramSeries, _super);\n    function HistogramSeries() {\n        var _a;\n        var _this = _super.call(this) || this;\n        // Need to put column and label nodes into separate groups, because even though label nodes are\n        // created after the column nodes, this only guarantees that labels will always be on top of columns\n        // on the first run. If on the next run more columns are added, they might clip the labels\n        // rendered during the previous run.\n        _this.rectGroup = _this.group.appendChild(new Group());\n        _this.textGroup = _this.group.appendChild(new Group());\n        _this.rectSelection = Selection.select(_this.rectGroup).selectAll();\n        _this.textSelection = Selection.select(_this.textGroup).selectAll();\n        _this.binnedData = [];\n        _this.xDomain = [];\n        _this.yDomain = [];\n        _this.label = new HistogramSeriesLabel();\n        _this.seriesItemEnabled = true;\n        _this.fill = undefined;\n        _this.stroke = undefined;\n        _this.fillOpacity = 1;\n        _this.strokeOpacity = 1;\n        _this.lineDash = undefined;\n        _this.lineDashOffset = 0;\n        _this.directionKeys = (_a = {},\n            _a[ChartAxisDirection.X] = ['xKey'],\n            _a[ChartAxisDirection.Y] = ['yKey'],\n            _a);\n        _this._xKey = '';\n        _this._areaPlot = false;\n        _this._xName = '';\n        _this._yKey = '';\n        _this._yName = '';\n        _this._strokeWidth = 1;\n        _this.highlightStyle = { fill: 'yellow' };\n        _this.label.enabled = false;\n        _this.label.addEventListener('change', _this.update, _this);\n        return _this;\n    }\n    HistogramSeries.prototype.getKeys = function (direction) {\n        var _this = this;\n        var directionKeys = this.directionKeys;\n        var keys = directionKeys && directionKeys[direction];\n        var values = [];\n        if (keys) {\n            keys.forEach(function (key) {\n                var value = _this[key];\n                if (value) {\n                    if (Array.isArray(value)) {\n                        values.push.apply(values, value);\n                    }\n                    else {\n                        values.push(value);\n                    }\n                }\n            });\n        }\n        return values;\n    };\n    Object.defineProperty(HistogramSeries.prototype, \"xKey\", {\n        get: function () {\n            return this._xKey;\n        },\n        set: function (value) {\n            if (this._xKey !== value) {\n                this._xKey = value;\n                this.scheduleData();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"areaPlot\", {\n        get: function () {\n            return this._areaPlot;\n        },\n        set: function (c) {\n            this._areaPlot = c;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"bins\", {\n        get: function () {\n            return this._bins;\n        },\n        set: function (bins) {\n            this._bins = bins;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"aggregation\", {\n        get: function () {\n            return this._aggregation;\n        },\n        set: function (aggregation) {\n            this._aggregation = aggregation;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"binCount\", {\n        get: function () {\n            return this._binCount;\n        },\n        set: function (binCount) {\n            this._binCount = binCount;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"xName\", {\n        get: function () {\n            return this._xName;\n        },\n        set: function (value) {\n            if (this._xName !== value) {\n                this._xName = value;\n                this.update();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"yKey\", {\n        get: function () {\n            return this._yKey;\n        },\n        set: function (yKey) {\n            this._yKey = yKey;\n            this.seriesItemEnabled = true;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"yName\", {\n        get: function () {\n            return this._yName;\n        },\n        set: function (values) {\n            this._yName = values;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"strokeWidth\", {\n        get: function () {\n            return this._strokeWidth;\n        },\n        set: function (value) {\n            if (this._strokeWidth !== value) {\n                this._strokeWidth = value;\n                this.update();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"shadow\", {\n        get: function () {\n            return this._shadow;\n        },\n        set: function (value) {\n            if (this._shadow !== value) {\n                this._shadow = value;\n                this.update();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HistogramSeries.prototype.onHighlightChange = function () {\n        this.updateRectNodes();\n    };\n    HistogramSeries.prototype.setColors = function (fills, strokes) {\n        this.fill = fills[0];\n        this.stroke = strokes[0];\n    };\n    /*  during processData phase, used to unify different ways of the user specifying\n        the bins. Returns bins in format [[min1, max1], [min2, max2] ... ] */\n    HistogramSeries.prototype.deriveBins = function () {\n        var _this = this;\n        var _a = this, bins = _a.bins, binCount = _a.binCount;\n        if (!this.data) {\n            return [];\n        }\n        if (bins && binCount) {\n            console.warn('bin domain and bin count both specified - these are mutually exclusive properties');\n        }\n        if (bins) {\n            // we have explicity set bins from user. Use those.\n            return bins;\n        }\n        var xData = this.data.map(function (datum) { return datum[_this.xKey]; });\n        var xDomain = this.fixNumericExtent(finiteExtent(xData), 'x');\n        var binStarts = ticks(xDomain[0], xDomain[1], this.binCount || defaultBinCount);\n        var binSize = tickStep(xDomain[0], xDomain[1], this.binCount || defaultBinCount);\n        var firstBinEnd = binStarts[0];\n        var expandStartToBin = function (n) { return [n, n + binSize]; };\n        return __spreadArrays([\n            [firstBinEnd - binSize, firstBinEnd]\n        ], binStarts.map(expandStartToBin));\n    };\n    HistogramSeries.prototype.placeDataInBins = function (data) {\n        var _this = this;\n        var xKey = this.xKey;\n        var derivedBins = this.deriveBins();\n        // creating a sorted copy allows binning in O(n) rather than O(nÂ²)\n        // but at the expense of more temporary memory\n        var sortedData = data.slice().sort(function (a, b) {\n            if (a[xKey] < b[xKey]) {\n                return -1;\n            }\n            if (a[xKey] > b[xKey]) {\n                return 1;\n            }\n            return 0;\n        });\n        var currentBin = 0;\n        var bins = [new HistogramBin(derivedBins[0])];\n        sortedData.forEach(function (datum) {\n            while (datum[xKey] > derivedBins[currentBin][1]) {\n                currentBin++;\n                bins.push(new HistogramBin(derivedBins[currentBin]));\n            }\n            bins[currentBin].addDatum(datum);\n        });\n        bins.forEach(function (b) { return b.calculateAggregatedValue(_this._aggregation, _this.yKey); });\n        return bins;\n    };\n    Object.defineProperty(HistogramSeries.prototype, \"xMax\", {\n        get: function () {\n            var _this = this;\n            return this.data && this.data.reduce(function (acc, datum) {\n                return Math.max(acc, datum[_this.xKey]);\n            }, Number.NEGATIVE_INFINITY);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HistogramSeries.prototype.processData = function () {\n        var _this = this;\n        var _a = this, xKey = _a.xKey, data = _a.data;\n        this.binnedData = this.placeDataInBins(xKey && data ? data : []);\n        var yData = this.binnedData.map(function (b) { return b.getY(_this.areaPlot); });\n        var yMinMax = numericExtent(yData);\n        this.yDomain = this.fixNumericExtent([0, yMinMax ? yMinMax[1] : 1], 'y');\n        var firstBin = this.binnedData[0];\n        var lastBin = this.binnedData[this.binnedData.length - 1];\n        var xMin = firstBin.domain[0];\n        var xMax = lastBin.domain[1];\n        this.xDomain = [xMin, xMax];\n        this.fireEvent({ type: 'dataProcessed' });\n        return true;\n    };\n    HistogramSeries.prototype.getDomain = function (direction) {\n        if (direction === ChartAxisDirection.X) {\n            return this.xDomain;\n        }\n        else {\n            return this.yDomain;\n        }\n    };\n    HistogramSeries.prototype.fireNodeClickEvent = function (datum) {\n        this.fireEvent({\n            type: 'nodeClick',\n            series: this,\n            datum: datum.seriesDatum,\n            xKey: this.xKey\n        });\n    };\n    HistogramSeries.prototype.update = function () {\n        var _a = this, visible = _a.visible, chart = _a.chart, xAxis = _a.xAxis, yAxis = _a.yAxis;\n        this.group.visible = visible;\n        if (!xAxis || !yAxis || !visible || !chart || chart.layoutPending || chart.dataPending) {\n            return;\n        }\n        var nodeData = this.generateNodeData();\n        this.updateRectSelection(nodeData);\n        this.updateRectNodes();\n        this.updateTextSelection(nodeData);\n        this.updateTextNodes();\n    };\n    HistogramSeries.prototype.generateNodeData = function () {\n        var _this = this;\n        if (!this.seriesItemEnabled) {\n            return [];\n        }\n        var _a = this, xScale = _a.xAxis.scale, yScale = _a.yAxis.scale, fill = _a.fill, stroke = _a.stroke, strokeWidth = _a.strokeWidth;\n        var nodeData = [];\n        var defaultLabelFormatter = function (params) { return String(params.value); };\n        var _b = this.label, _c = _b.formatter, labelFormatter = _c === void 0 ? defaultLabelFormatter : _c, labelFontStyle = _b.fontStyle, labelFontWeight = _b.fontWeight, labelFontSize = _b.fontSize, labelFontFamily = _b.fontFamily, labelColor = _b.color;\n        this.binnedData.forEach(function (binOfData) {\n            var total = binOfData.aggregatedValue, frequency = binOfData.frequency, _a = binOfData.domain, xDomainMin = _a[0], xDomainMax = _a[1], relativeHeight = binOfData.relativeHeight;\n            var xMinPx = xScale.convert(xDomainMin), xMaxPx = xScale.convert(xDomainMax), \n            // note: assuming can't be negative:\n            y = _this.areaPlot ? relativeHeight : (_this.yKey ? total : frequency), yZeroPx = yScale.convert(0), yMaxPx = yScale.convert(y), w = xMaxPx - xMinPx, h = Math.abs(yMaxPx - yZeroPx);\n            var selectionDatumLabel = y !== 0 ? {\n                text: labelFormatter({ value: binOfData.aggregatedValue }),\n                fontStyle: labelFontStyle,\n                fontWeight: labelFontWeight,\n                fontSize: labelFontSize,\n                fontFamily: labelFontFamily,\n                fill: labelColor,\n                x: xMinPx + w / 2,\n                y: yMaxPx + h / 2\n            } : undefined;\n            nodeData.push({\n                series: _this,\n                seriesDatum: binOfData,\n                // since each selection is an aggregation of multiple data.\n                x: xMinPx,\n                y: yMaxPx,\n                width: w,\n                height: h,\n                fill: fill,\n                stroke: stroke,\n                strokeWidth: strokeWidth,\n                label: selectionDatumLabel,\n            });\n        });\n        return nodeData;\n    };\n    HistogramSeries.prototype.updateRectSelection = function (nodeData) {\n        var updateRects = this.rectSelection.setData(nodeData);\n        updateRects.exit.remove();\n        var enterRects = updateRects.enter.append(Rect).each(function (rect) {\n            rect.tag = HistogramSeriesNodeTag.Bin;\n            rect.crisp = true;\n        });\n        this.rectSelection = updateRects.merge(enterRects);\n    };\n    HistogramSeries.prototype.updateRectNodes = function () {\n        var _this = this;\n        if (!this.chart) {\n            return;\n        }\n        var highlightedDatum = this.chart.highlightedDatum;\n        var _a = this, fillOpacity = _a.fillOpacity, strokeOpacity = _a.strokeOpacity, shadow = _a.shadow, _b = _a.highlightStyle, fill = _b.fill, stroke = _b.stroke;\n        this.rectSelection.each(function (rect, datum) {\n            var highlighted = datum === highlightedDatum;\n            rect.x = datum.x;\n            rect.y = datum.y;\n            rect.width = datum.width;\n            rect.height = datum.height;\n            rect.fill = highlighted && fill !== undefined ? fill : datum.fill;\n            rect.stroke = highlighted && stroke !== undefined ? stroke : datum.stroke;\n            rect.fillOpacity = fillOpacity;\n            rect.strokeOpacity = strokeOpacity;\n            rect.strokeWidth = datum.strokeWidth;\n            rect.lineDash = _this.lineDash;\n            rect.lineDashOffset = _this.lineDashOffset;\n            rect.fillShadow = shadow;\n            rect.visible = datum.height > 0; // prevent stroke from rendering for zero height columns\n        });\n    };\n    HistogramSeries.prototype.updateTextSelection = function (nodeData) {\n        var updateTexts = this.textSelection.setData(nodeData);\n        updateTexts.exit.remove();\n        var enterTexts = updateTexts.enter.append(Text).each(function (text) {\n            text.tag = HistogramSeriesNodeTag.Label;\n            text.pointerEvents = PointerEvents.None;\n            text.textAlign = 'center';\n            text.textBaseline = 'middle';\n        });\n        this.textSelection = updateTexts.merge(enterTexts);\n    };\n    HistogramSeries.prototype.updateTextNodes = function () {\n        var labelEnabled = this.label.enabled;\n        this.textSelection.each(function (text, datum) {\n            var label = datum.label;\n            if (label && labelEnabled) {\n                text.text = label.text;\n                text.x = label.x;\n                text.y = label.y;\n                text.fontStyle = label.fontStyle;\n                text.fontWeight = label.fontWeight;\n                text.fontSize = label.fontSize;\n                text.fontFamily = label.fontFamily;\n                text.fill = label.fill;\n                text.visible = true;\n            }\n            else {\n                text.visible = false;\n            }\n        });\n    };\n    HistogramSeries.prototype.getTooltipHtml = function (nodeDatum) {\n        var _a = this, xKey = _a.xKey, yKey = _a.yKey;\n        if (!xKey) {\n            return '';\n        }\n        var _b = this, xName = _b.xName, yName = _b.yName, color = _b.fill, tooltipRenderer = _b.tooltipRenderer, aggregation = _b.aggregation;\n        var bin = nodeDatum.seriesDatum;\n        var aggregatedValue = bin.aggregatedValue, frequency = bin.frequency, _c = bin.domain, rangeMin = _c[0], rangeMax = _c[1];\n        var title = (xName || xKey) + \" \" + toFixed(rangeMin) + \" - \" + toFixed(rangeMax);\n        var content = yKey ?\n            \"<b>\" + (yName || yKey) + \" (\" + aggregation + \")</b>: \" + toFixed(aggregatedValue) + \"<br>\" :\n            '';\n        content += \"<b>Frequency</b>: \" + frequency;\n        var defaults = {\n            title: title,\n            titleBackgroundColor: color,\n            content: content\n        };\n        if (tooltipRenderer) {\n            return toTooltipHtml(tooltipRenderer({\n                datum: bin,\n                xKey: xKey,\n                xValue: bin.domain,\n                xName: xName,\n                yKey: yKey,\n                yValue: bin.aggregatedValue,\n                yName: yName,\n                color: color\n            }), defaults);\n        }\n        return toTooltipHtml(defaults);\n    };\n    HistogramSeries.prototype.listSeriesItems = function (legendData) {\n        var _a = this, id = _a.id, data = _a.data, yKey = _a.yKey, yName = _a.yName, seriesItemEnabled = _a.seriesItemEnabled, fill = _a.fill, stroke = _a.stroke, fillOpacity = _a.fillOpacity, strokeOpacity = _a.strokeOpacity;\n        if (data && data.length) {\n            legendData.push({\n                id: id,\n                itemId: yKey,\n                enabled: seriesItemEnabled,\n                label: {\n                    text: yName || yKey || 'Frequency'\n                },\n                marker: {\n                    fill: fill || 'rgba(0, 0, 0, 0)',\n                    stroke: stroke || 'rgba(0, 0, 0, 0)',\n                    fillOpacity: fillOpacity,\n                    strokeOpacity: strokeOpacity\n                }\n            });\n        }\n    };\n    HistogramSeries.prototype.toggleSeriesItem = function (itemId, enabled) {\n        if (itemId === this.yKey) {\n            this.seriesItemEnabled = enabled;\n        }\n        this.scheduleData();\n    };\n    HistogramSeries.className = 'HistogramSeries';\n    HistogramSeries.type = 'histogram';\n    __decorate([\n        reactive('dataChange')\n    ], HistogramSeries.prototype, \"fill\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], HistogramSeries.prototype, \"stroke\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], HistogramSeries.prototype, \"fillOpacity\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], HistogramSeries.prototype, \"strokeOpacity\", void 0);\n    __decorate([\n        reactive('update')\n    ], HistogramSeries.prototype, \"lineDash\", void 0);\n    __decorate([\n        reactive('update')\n    ], HistogramSeries.prototype, \"lineDashOffset\", void 0);\n    return HistogramSeries;\n}(CartesianSeries));\nexport { HistogramSeries };\n"]},"metadata":{},"sourceType":"module"}