{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n};\n\nimport { Group } from \"../../../scene/group\";\nimport { Selection } from \"../../../scene/selection\";\nimport { Rect } from \"../../../scene/shape/rect\";\nimport { Text } from \"../../../scene/shape/text\";\nimport { BandScale } from \"../../../scale/bandScale\";\nimport { Label } from \"../../label\";\nimport { PointerEvents } from \"../../../scene/node\";\nimport { CartesianSeries } from \"./cartesianSeries\";\nimport { ChartAxisDirection, flipChartAxisDirection } from \"../../chartAxis\";\nimport { toTooltipHtml } from \"../../chart\";\nimport { findLargestMinMax, findMinMax } from \"../../../util/array\";\nimport { toFixed } from \"../../../util/number\";\nimport { equal } from \"../../../util/equal\";\nimport { reactive } from \"../../../util/observable\";\nvar BarSeriesNodeTag;\n\n(function (BarSeriesNodeTag) {\n  BarSeriesNodeTag[BarSeriesNodeTag[\"Bar\"] = 0] = \"Bar\";\n  BarSeriesNodeTag[BarSeriesNodeTag[\"Label\"] = 1] = \"Label\";\n})(BarSeriesNodeTag || (BarSeriesNodeTag = {}));\n\nvar BarSeriesLabel =\n/** @class */\nfunction (_super) {\n  __extends(BarSeriesLabel, _super);\n\n  function BarSeriesLabel() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  __decorate([reactive('change')], BarSeriesLabel.prototype, \"formatter\", void 0);\n\n  return BarSeriesLabel;\n}(Label);\n\nvar BarSeries =\n/** @class */\nfunction (_super) {\n  __extends(BarSeries, _super);\n\n  function BarSeries() {\n    var _a;\n\n    var _this = _super.call(this) || this; // Need to put bar and label nodes into separate groups, because even though label nodes are\n    // created after the bar nodes, this only guarantees that labels will always be on top of bars\n    // on the first run. If on the next run more bars are added, they might clip the labels\n    // rendered during the previous run.\n\n\n    _this.rectGroup = _this.group.appendChild(new Group());\n    _this.textGroup = _this.group.appendChild(new Group());\n    _this.rectSelection = Selection.select(_this.rectGroup).selectAll();\n    _this.textSelection = Selection.select(_this.textGroup).selectAll();\n    _this.xData = [];\n    _this.yData = [];\n    _this.yDomain = [];\n    _this.label = new BarSeriesLabel();\n    /**\n     * The assumption is that the values will be reset (to `true`)\n     * in the {@link yKeys} setter.\n     */\n\n    _this.seriesItemEnabled = new Map();\n    _this.flipXY = false;\n    _this.fills = ['#c16068', '#a2bf8a', '#ebcc87', '#80a0c3', '#b58dae', '#85c0d1'];\n    _this.strokes = ['#874349', '#718661', '#a48f5f', '#5a7088', '#7f637a', '#5d8692'];\n    _this.fillOpacity = 1;\n    _this.strokeOpacity = 1;\n    _this.lineDash = undefined;\n    _this.lineDashOffset = 0;\n    /**\n     * Used to get the position of bars within each group.\n     */\n\n    _this.groupScale = new BandScale();\n    _this.directionKeys = (_a = {}, _a[ChartAxisDirection.X] = ['xKey'], _a[ChartAxisDirection.Y] = ['yKeys'], _a);\n    _this._xKey = '';\n    _this._xName = '';\n    /**\n     * With a single value in the `yKeys` array we get the regular bar series.\n     * With multiple values, we get the stacked bar series.\n     * If the {@link grouped} set to `true`, we get the grouped bar series.\n     * @param values\n     */\n\n    _this._yKeys = [];\n    _this._yNames = [];\n    _this.grouped = false;\n    _this._strokeWidth = 1;\n    _this.highlightStyle = {\n      fill: 'yellow'\n    };\n\n    _this.addEventListener('update', _this.update);\n\n    _this.label.enabled = false;\n\n    _this.label.addEventListener('change', _this.update, _this);\n\n    return _this;\n  }\n\n  BarSeries.prototype.getKeys = function (direction) {\n    var _this = this;\n\n    var directionKeys = this.directionKeys;\n    var keys = directionKeys && directionKeys[this.flipXY ? flipChartAxisDirection(direction) : direction];\n    var values = [];\n\n    if (keys) {\n      keys.forEach(function (key) {\n        var value = _this[key];\n\n        if (value) {\n          if (Array.isArray(value)) {\n            values.push.apply(values, value);\n          } else {\n            values.push(value);\n          }\n        }\n      });\n    }\n\n    return values;\n  };\n\n  Object.defineProperty(BarSeries.prototype, \"xKey\", {\n    get: function () {\n      return this._xKey;\n    },\n    set: function (value) {\n      if (this._xKey !== value) {\n        this._xKey = value;\n        this.xData = [];\n        this.scheduleData();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(BarSeries.prototype, \"xName\", {\n    get: function () {\n      return this._xName;\n    },\n    set: function (value) {\n      if (this._xName !== value) {\n        this._xName = value;\n        this.update();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(BarSeries.prototype, \"yKeys\", {\n    get: function () {\n      return this._yKeys;\n    },\n    set: function (values) {\n      if (!equal(this._yKeys, values)) {\n        this._yKeys = values;\n        this.yData = [];\n        var seriesItemEnabled_1 = this.seriesItemEnabled;\n        seriesItemEnabled_1.clear();\n        values.forEach(function (key) {\n          return seriesItemEnabled_1.set(key, true);\n        });\n        var groupScale = this.groupScale;\n        groupScale.domain = values;\n        groupScale.padding = 0.1;\n        groupScale.round = true;\n        this.scheduleData();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(BarSeries.prototype, \"yNames\", {\n    get: function () {\n      return this._yNames;\n    },\n    set: function (values) {\n      this._yNames = values;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  BarSeries.prototype.setColors = function (fills, strokes) {\n    this.fills = fills;\n    this.strokes = strokes;\n  };\n\n  Object.defineProperty(BarSeries.prototype, \"normalizedTo\", {\n    get: function () {\n      return this._normalizedTo;\n    },\n    set: function (value) {\n      var absValue = value ? Math.abs(value) : undefined;\n\n      if (this._normalizedTo !== absValue) {\n        this._normalizedTo = absValue;\n        this.scheduleData();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(BarSeries.prototype, \"strokeWidth\", {\n    get: function () {\n      return this._strokeWidth;\n    },\n    set: function (value) {\n      if (this._strokeWidth !== value) {\n        this._strokeWidth = value;\n        this.update();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(BarSeries.prototype, \"shadow\", {\n    get: function () {\n      return this._shadow;\n    },\n    set: function (value) {\n      if (this._shadow !== value) {\n        this._shadow = value;\n        this.update();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  BarSeries.prototype.onHighlightChange = function () {\n    this.updateRectNodes();\n  };\n\n  BarSeries.prototype.processData = function () {\n    var _a = this,\n        xKey = _a.xKey,\n        yKeys = _a.yKeys,\n        seriesItemEnabled = _a.seriesItemEnabled;\n\n    var data = xKey && yKeys.length && this.data ? this.data : []; // If the data is an array of rows like so:\n    //\n    // [{\n    //   xKey: 'Jan',\n    //   yKey1: 5,\n    //   yKey2: 7,\n    //   yKey3: -9,\n    // }, {\n    //   xKey: 'Feb',\n    //   yKey1: 10,\n    //   yKey2: -15,\n    //   yKey3: 20\n    // }]\n    //\n\n    var keysFound = true; // only warn once\n\n    this.xData = data.map(function (datum) {\n      if (keysFound && !(xKey in datum)) {\n        keysFound = false;\n        console.warn(\"The key '\" + xKey + \"' was not found in the data: \", datum);\n      }\n\n      return datum[xKey];\n    });\n    this.yData = data.map(function (datum) {\n      return yKeys.map(function (yKey) {\n        if (keysFound && !(yKey in datum)) {\n          keysFound = false;\n          console.warn(\"The key '\" + yKey + \"' was not found in the data: \", datum);\n        }\n\n        var value = datum[yKey];\n        return isFinite(value) && seriesItemEnabled.get(yKey) ? value : 0;\n      });\n    }); // xData: ['Jan', 'Feb']\n    //\n    // yData: [\n    //   [5, 7, -9],\n    //   [10, -15, 20]\n    // ]\n\n    var yMinMax = this.yData.map(function (values) {\n      return findMinMax(values);\n    }); // used for normalization of stacked bars\n\n    var _b = this,\n        yData = _b.yData,\n        normalizedTo = _b.normalizedTo;\n\n    var yMin = Infinity;\n    var yMax = -Infinity;\n\n    if (this.grouped) {\n      // Find the tallest positive/negative bar in each group,\n      // then find the tallest positive/negative bar overall.\n      // The `yMin` should always be <= 0,\n      // otherwise with the `yData` like [300, 200, 100] the last bar\n      // will have zero height, because the y-axis range is [100, 300].\n      yMin = Math.min.apply(Math, __spreadArrays([0], yData.map(function (values) {\n        return Math.min.apply(Math, values);\n      })));\n      yMax = Math.max.apply(Math, yData.map(function (values) {\n        return Math.max.apply(Math, values);\n      }));\n    } else {\n      // stacked or regular\n      var yLargestMinMax = findLargestMinMax(yMinMax);\n\n      if (normalizedTo && isFinite(normalizedTo)) {\n        yMin = yLargestMinMax.min < 0 ? -normalizedTo : 0;\n        yMax = normalizedTo;\n        yData.forEach(function (stackValues, i) {\n          return stackValues.forEach(function (y, j) {\n            if (y < 0) {\n              stackValues[j] = -y / yMinMax[i].min * normalizedTo;\n            } else {\n              stackValues[j] = y / yMinMax[i].max * normalizedTo;\n            }\n          });\n        });\n      } else {\n        yMin = yLargestMinMax.min;\n        yMax = yLargestMinMax.max;\n      }\n    }\n\n    this.yDomain = this.fixNumericExtent([yMin, yMax], 'y');\n    this.fireEvent({\n      type: 'dataProcessed'\n    });\n    return true;\n  };\n\n  BarSeries.prototype.getDomain = function (direction) {\n    if (this.flipXY) {\n      direction = flipChartAxisDirection(direction);\n    }\n\n    if (direction === ChartAxisDirection.X) {\n      return this.xData;\n    } else {\n      return this.yDomain;\n    }\n  };\n\n  BarSeries.prototype.fireNodeClickEvent = function (datum) {\n    this.fireEvent({\n      type: 'nodeClick',\n      series: this,\n      datum: datum.seriesDatum,\n      xKey: this.xKey,\n      yKey: datum.yKey\n    });\n  };\n\n  BarSeries.prototype.generateNodeData = function () {\n    var _this = this;\n\n    if (!this.data) {\n      return [];\n    }\n\n    var flipXY = this.flipXY;\n    var xAxis = flipXY ? this.yAxis : this.xAxis;\n    var yAxis = flipXY ? this.xAxis : this.yAxis;\n    var xScale = xAxis.scale;\n    var yScale = yAxis.scale;\n\n    var _a = this,\n        groupScale = _a.groupScale,\n        yKeys = _a.yKeys,\n        fills = _a.fills,\n        strokes = _a.strokes,\n        grouped = _a.grouped,\n        strokeWidth = _a.strokeWidth,\n        seriesItemEnabled = _a.seriesItemEnabled,\n        data = _a.data,\n        xData = _a.xData,\n        yData = _a.yData;\n\n    var label = this.label;\n    var labelFontStyle = label.fontStyle;\n    var labelFontWeight = label.fontWeight;\n    var labelFontSize = label.fontSize;\n    var labelFontFamily = label.fontFamily;\n    var labelColor = label.color;\n    var labelFormatter = label.formatter;\n    groupScale.range = [0, xScale.bandwidth];\n    var barWidth = grouped ? groupScale.bandwidth : xScale.bandwidth;\n    var nodeData = [];\n    xData.forEach(function (category, i) {\n      var yDatum = yData[i];\n      var seriesDatum = data[i];\n      var x = xScale.convert(category);\n      var prevMin = 0;\n      var prevMax = 0;\n\n      for (var j = 0; j < yDatum.length; j++) {\n        var curr = yDatum[j];\n        var yKey = yKeys[j];\n        var barX = grouped ? x + groupScale.convert(yKey) : x;\n\n        if (!xAxis.inRange(barX, barWidth)) {\n          continue;\n        }\n\n        var prev = curr < 0 ? prevMin : prevMax;\n        var y = yScale.convert(grouped ? curr : prev + curr);\n        var bottomY = yScale.convert(grouped ? 0 : prev);\n        var yValue = seriesDatum[yKey]; // unprocessed y-value\n\n        var yValueIsNumber = typeof yValue === 'number';\n        var labelText = void 0;\n\n        if (labelFormatter) {\n          labelText = labelFormatter({\n            value: yValueIsNumber ? yValue : undefined\n          });\n        } else {\n          labelText = yValueIsNumber && isFinite(yValue) ? yValue.toFixed(2) : '';\n        }\n\n        nodeData.push({\n          series: _this,\n          seriesDatum: seriesDatum,\n          yValue: yValue,\n          yKey: yKey,\n          x: flipXY ? Math.min(y, bottomY) : barX,\n          y: flipXY ? barX : Math.min(y, bottomY),\n          width: flipXY ? Math.abs(bottomY - y) : barWidth,\n          height: flipXY ? barWidth : Math.abs(bottomY - y),\n          fill: fills[j % fills.length],\n          stroke: strokes[j % strokes.length],\n          strokeWidth: strokeWidth,\n          label: seriesItemEnabled.get(yKey) && labelText ? {\n            text: labelText,\n            fontStyle: labelFontStyle,\n            fontWeight: labelFontWeight,\n            fontSize: labelFontSize,\n            fontFamily: labelFontFamily,\n            fill: labelColor,\n            x: flipXY ? y + (yValue >= 0 ? -1 : 1) * Math.abs(bottomY - y) / 2 : barX + barWidth / 2,\n            y: flipXY ? barX + barWidth / 2 : y + (yValue >= 0 ? 1 : -1) * Math.abs(bottomY - y) / 2\n          } : undefined\n        });\n\n        if (!grouped) {\n          if (curr < 0) {\n            prevMin += curr;\n          } else {\n            prevMax += curr;\n          }\n        }\n      }\n    });\n    return nodeData;\n  };\n\n  BarSeries.prototype.update = function () {\n    var _a = this,\n        visible = _a.visible,\n        chart = _a.chart,\n        xAxis = _a.xAxis,\n        yAxis = _a.yAxis,\n        xData = _a.xData,\n        yData = _a.yData;\n\n    this.group.visible = visible;\n\n    if (!chart || chart.layoutPending || chart.dataPending || !xAxis || !yAxis || !visible || !xData.length || !yData.length) {\n      return;\n    }\n\n    var nodeData = this.generateNodeData();\n    this.updateRectSelection(nodeData);\n    this.updateRectNodes();\n    this.updateTextSelection(nodeData);\n    this.updateTextNodes();\n  };\n\n  BarSeries.prototype.updateRectSelection = function (selectionData) {\n    var updateRects = this.rectSelection.setData(selectionData);\n    updateRects.exit.remove();\n    var enterRects = updateRects.enter.append(Rect).each(function (rect) {\n      rect.tag = BarSeriesNodeTag.Bar;\n      rect.crisp = true;\n    });\n    this.rectSelection = updateRects.merge(enterRects);\n  };\n\n  BarSeries.prototype.updateRectNodes = function () {\n    var _this = this;\n\n    if (!this.chart) {\n      return;\n    }\n\n    var _a = this,\n        fillOpacity = _a.fillOpacity,\n        strokeOpacity = _a.strokeOpacity,\n        _b = _a.highlightStyle,\n        fill = _b.fill,\n        stroke = _b.stroke,\n        shadow = _a.shadow,\n        formatter = _a.formatter,\n        xKey = _a.xKey,\n        flipXY = _a.flipXY;\n\n    var highlightedDatum = this.chart.highlightedDatum;\n    this.rectSelection.each(function (rect, datum) {\n      var highlighted = datum === highlightedDatum;\n      var rectFill = highlighted && fill !== undefined ? fill : datum.fill;\n      var rectStroke = highlighted && stroke !== undefined ? stroke : datum.stroke;\n      var format = undefined;\n\n      if (formatter) {\n        format = formatter({\n          datum: datum.seriesDatum,\n          fill: rectFill,\n          stroke: rectStroke,\n          strokeWidth: datum.strokeWidth,\n          highlighted: highlighted,\n          xKey: xKey,\n          yKey: datum.yKey\n        });\n      }\n\n      rect.x = datum.x;\n      rect.y = datum.y;\n      rect.width = datum.width;\n      rect.height = datum.height;\n      rect.fill = format && format.fill || rectFill;\n      rect.stroke = format && format.stroke || rectStroke;\n      rect.strokeWidth = format && format.strokeWidth !== undefined ? format.strokeWidth : datum.strokeWidth;\n      rect.fillOpacity = fillOpacity;\n      rect.strokeOpacity = strokeOpacity;\n      rect.lineDash = _this.lineDash;\n      rect.lineDashOffset = _this.lineDashOffset;\n      rect.fillShadow = shadow; // Prevent stroke from rendering for zero height columns and zero width bars.\n\n      rect.visible = flipXY ? datum.width > 0 : datum.height > 0;\n    });\n  };\n\n  BarSeries.prototype.updateTextSelection = function (selectionData) {\n    var updateTexts = this.textSelection.setData(selectionData);\n    updateTexts.exit.remove();\n    var enterTexts = updateTexts.enter.append(Text).each(function (text) {\n      text.tag = BarSeriesNodeTag.Label;\n      text.pointerEvents = PointerEvents.None;\n      text.textAlign = 'center';\n      text.textBaseline = 'middle';\n    });\n    this.textSelection = updateTexts.merge(enterTexts);\n  };\n\n  BarSeries.prototype.updateTextNodes = function () {\n    var labelEnabled = this.label.enabled;\n    this.textSelection.each(function (text, datum) {\n      var label = datum.label;\n\n      if (label && labelEnabled) {\n        text.fontStyle = label.fontStyle;\n        text.fontWeight = label.fontWeight;\n        text.fontSize = label.fontSize;\n        text.fontFamily = label.fontFamily;\n        text.text = label.text;\n        text.x = label.x;\n        text.y = label.y;\n        text.fill = label.fill;\n        text.visible = true;\n      } else {\n        text.visible = false;\n      }\n    });\n  };\n\n  BarSeries.prototype.getTooltipHtml = function (nodeDatum) {\n    var xKey = this.xKey;\n    var yKey = nodeDatum.yKey;\n\n    if (!xKey || !yKey) {\n      return '';\n    }\n\n    var _a = this,\n        xName = _a.xName,\n        yKeys = _a.yKeys,\n        yNames = _a.yNames,\n        fills = _a.fills,\n        tooltipRenderer = _a.tooltipRenderer;\n\n    var datum = nodeDatum.seriesDatum;\n    var yKeyIndex = yKeys.indexOf(yKey);\n    var yName = yNames[yKeyIndex];\n    var color = fills[yKeyIndex % fills.length];\n    var xValue = datum[xKey];\n    var yValue = datum[yKey];\n    var xString = typeof xValue === 'number' ? toFixed(xValue) : String(xValue);\n    var yString = typeof yValue === 'number' ? toFixed(yValue) : String(yValue);\n    var title = yName;\n    var content = xString + ': ' + yString;\n    var defaults = {\n      title: title,\n      titleBackgroundColor: color,\n      content: content\n    };\n\n    if (tooltipRenderer) {\n      return toTooltipHtml(tooltipRenderer({\n        datum: datum,\n        xKey: xKey,\n        xValue: xValue,\n        xName: xName,\n        yKey: yKey,\n        yValue: yValue,\n        yName: yName,\n        color: color\n      }), defaults);\n    }\n\n    return toTooltipHtml(defaults);\n  };\n\n  BarSeries.prototype.listSeriesItems = function (legendData) {\n    var _a = this,\n        id = _a.id,\n        data = _a.data,\n        xKey = _a.xKey,\n        yKeys = _a.yKeys,\n        yNames = _a.yNames,\n        seriesItemEnabled = _a.seriesItemEnabled,\n        fills = _a.fills,\n        strokes = _a.strokes,\n        fillOpacity = _a.fillOpacity,\n        strokeOpacity = _a.strokeOpacity;\n\n    if (data && data.length && xKey && yKeys.length) {\n      yKeys.forEach(function (yKey, index) {\n        legendData.push({\n          id: id,\n          itemId: yKey,\n          enabled: seriesItemEnabled.get(yKey) || false,\n          label: {\n            text: yNames[index] || yKeys[index]\n          },\n          marker: {\n            fill: fills[index % fills.length],\n            stroke: strokes[index % strokes.length],\n            fillOpacity: fillOpacity,\n            strokeOpacity: strokeOpacity\n          }\n        });\n      });\n    }\n  };\n\n  BarSeries.prototype.toggleSeriesItem = function (itemId, enabled) {\n    var seriesItemEnabled = this.seriesItemEnabled;\n    var enabledSeriesItems = [];\n    seriesItemEnabled.set(itemId, enabled);\n    seriesItemEnabled.forEach(function (enabled, yKey) {\n      if (enabled) {\n        enabledSeriesItems.push(yKey);\n      }\n    });\n    this.groupScale.domain = enabledSeriesItems;\n    this.scheduleData();\n  };\n\n  BarSeries.className = 'BarSeries';\n  BarSeries.type = 'bar';\n\n  __decorate([reactive('layoutChange')], BarSeries.prototype, \"flipXY\", void 0);\n\n  __decorate([reactive('dataChange')], BarSeries.prototype, \"fills\", void 0);\n\n  __decorate([reactive('dataChange')], BarSeries.prototype, \"strokes\", void 0);\n\n  __decorate([reactive('layoutChange')], BarSeries.prototype, \"fillOpacity\", void 0);\n\n  __decorate([reactive('layoutChange')], BarSeries.prototype, \"strokeOpacity\", void 0);\n\n  __decorate([reactive('update')], BarSeries.prototype, \"lineDash\", void 0);\n\n  __decorate([reactive('update')], BarSeries.prototype, \"lineDashOffset\", void 0);\n\n  __decorate([reactive('update')], BarSeries.prototype, \"formatter\", void 0);\n\n  __decorate([reactive('dataChange')], BarSeries.prototype, \"grouped\", void 0);\n\n  return BarSeries;\n}(CartesianSeries);\n\nexport { BarSeries };","map":{"version":3,"sources":["E:/Expense-Tracker/frontend/node_modules/ag-charts-community/dist/es6/chart/series/cartesian/barSeries.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__spreadArrays","s","il","k","a","j","jl","Group","Selection","Rect","Text","BandScale","Label","PointerEvents","CartesianSeries","ChartAxisDirection","flipChartAxisDirection","toTooltipHtml","findLargestMinMax","findMinMax","toFixed","equal","reactive","BarSeriesNodeTag","BarSeriesLabel","_super","apply","BarSeries","_a","_this","call","rectGroup","group","appendChild","textGroup","rectSelection","select","selectAll","textSelection","xData","yData","yDomain","label","seriesItemEnabled","Map","flipXY","fills","strokes","fillOpacity","strokeOpacity","lineDash","undefined","lineDashOffset","groupScale","directionKeys","X","Y","_xKey","_xName","_yKeys","_yNames","grouped","_strokeWidth","highlightStyle","fill","addEventListener","update","enabled","getKeys","direction","keys","values","forEach","value","isArray","push","get","set","scheduleData","enumerable","configurable","seriesItemEnabled_1","clear","domain","padding","round","setColors","_normalizedTo","absValue","Math","abs","_shadow","onHighlightChange","updateRectNodes","processData","xKey","yKeys","data","keysFound","map","datum","console","warn","yKey","isFinite","yMinMax","_b","normalizedTo","yMin","Infinity","yMax","min","max","yLargestMinMax","stackValues","y","fixNumericExtent","fireEvent","type","getDomain","fireNodeClickEvent","series","seriesDatum","generateNodeData","xAxis","yAxis","xScale","scale","yScale","strokeWidth","labelFontStyle","fontStyle","labelFontWeight","fontWeight","labelFontSize","fontSize","labelFontFamily","fontFamily","labelColor","color","labelFormatter","formatter","range","bandwidth","barWidth","nodeData","category","yDatum","x","convert","prevMin","prevMax","curr","barX","inRange","prev","bottomY","yValue","yValueIsNumber","labelText","width","height","stroke","text","visible","chart","layoutPending","dataPending","updateRectSelection","updateTextSelection","updateTextNodes","selectionData","updateRects","setData","exit","remove","enterRects","enter","append","each","rect","tag","Bar","crisp","merge","shadow","highlightedDatum","highlighted","rectFill","rectStroke","format","fillShadow","updateTexts","enterTexts","pointerEvents","None","textAlign","textBaseline","labelEnabled","getTooltipHtml","nodeDatum","xName","yNames","tooltipRenderer","yKeyIndex","indexOf","yName","xValue","xString","String","yString","title","content","defaults","titleBackgroundColor","listSeriesItems","legendData","id","index","itemId","marker","toggleSeriesItem","enabledSeriesItems","className"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { Group } from \"../../../scene/group\";\nimport { Selection } from \"../../../scene/selection\";\nimport { Rect } from \"../../../scene/shape/rect\";\nimport { Text } from \"../../../scene/shape/text\";\nimport { BandScale } from \"../../../scale/bandScale\";\nimport { Label } from \"../../label\";\nimport { PointerEvents } from \"../../../scene/node\";\nimport { CartesianSeries } from \"./cartesianSeries\";\nimport { ChartAxisDirection, flipChartAxisDirection } from \"../../chartAxis\";\nimport { toTooltipHtml } from \"../../chart\";\nimport { findLargestMinMax, findMinMax } from \"../../../util/array\";\nimport { toFixed } from \"../../../util/number\";\nimport { equal } from \"../../../util/equal\";\nimport { reactive } from \"../../../util/observable\";\nvar BarSeriesNodeTag;\n(function (BarSeriesNodeTag) {\n    BarSeriesNodeTag[BarSeriesNodeTag[\"Bar\"] = 0] = \"Bar\";\n    BarSeriesNodeTag[BarSeriesNodeTag[\"Label\"] = 1] = \"Label\";\n})(BarSeriesNodeTag || (BarSeriesNodeTag = {}));\nvar BarSeriesLabel = /** @class */ (function (_super) {\n    __extends(BarSeriesLabel, _super);\n    function BarSeriesLabel() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        reactive('change')\n    ], BarSeriesLabel.prototype, \"formatter\", void 0);\n    return BarSeriesLabel;\n}(Label));\nvar BarSeries = /** @class */ (function (_super) {\n    __extends(BarSeries, _super);\n    function BarSeries() {\n        var _a;\n        var _this = _super.call(this) || this;\n        // Need to put bar and label nodes into separate groups, because even though label nodes are\n        // created after the bar nodes, this only guarantees that labels will always be on top of bars\n        // on the first run. If on the next run more bars are added, they might clip the labels\n        // rendered during the previous run.\n        _this.rectGroup = _this.group.appendChild(new Group);\n        _this.textGroup = _this.group.appendChild(new Group);\n        _this.rectSelection = Selection.select(_this.rectGroup).selectAll();\n        _this.textSelection = Selection.select(_this.textGroup).selectAll();\n        _this.xData = [];\n        _this.yData = [];\n        _this.yDomain = [];\n        _this.label = new BarSeriesLabel();\n        /**\n         * The assumption is that the values will be reset (to `true`)\n         * in the {@link yKeys} setter.\n         */\n        _this.seriesItemEnabled = new Map();\n        _this.flipXY = false;\n        _this.fills = [\n            '#c16068',\n            '#a2bf8a',\n            '#ebcc87',\n            '#80a0c3',\n            '#b58dae',\n            '#85c0d1'\n        ];\n        _this.strokes = [\n            '#874349',\n            '#718661',\n            '#a48f5f',\n            '#5a7088',\n            '#7f637a',\n            '#5d8692'\n        ];\n        _this.fillOpacity = 1;\n        _this.strokeOpacity = 1;\n        _this.lineDash = undefined;\n        _this.lineDashOffset = 0;\n        /**\n         * Used to get the position of bars within each group.\n         */\n        _this.groupScale = new BandScale();\n        _this.directionKeys = (_a = {},\n            _a[ChartAxisDirection.X] = ['xKey'],\n            _a[ChartAxisDirection.Y] = ['yKeys'],\n            _a);\n        _this._xKey = '';\n        _this._xName = '';\n        /**\n         * With a single value in the `yKeys` array we get the regular bar series.\n         * With multiple values, we get the stacked bar series.\n         * If the {@link grouped} set to `true`, we get the grouped bar series.\n         * @param values\n         */\n        _this._yKeys = [];\n        _this._yNames = [];\n        _this.grouped = false;\n        _this._strokeWidth = 1;\n        _this.highlightStyle = { fill: 'yellow' };\n        _this.addEventListener('update', _this.update);\n        _this.label.enabled = false;\n        _this.label.addEventListener('change', _this.update, _this);\n        return _this;\n    }\n    BarSeries.prototype.getKeys = function (direction) {\n        var _this = this;\n        var directionKeys = this.directionKeys;\n        var keys = directionKeys && directionKeys[this.flipXY ? flipChartAxisDirection(direction) : direction];\n        var values = [];\n        if (keys) {\n            keys.forEach(function (key) {\n                var value = _this[key];\n                if (value) {\n                    if (Array.isArray(value)) {\n                        values.push.apply(values, value);\n                    }\n                    else {\n                        values.push(value);\n                    }\n                }\n            });\n        }\n        return values;\n    };\n    Object.defineProperty(BarSeries.prototype, \"xKey\", {\n        get: function () {\n            return this._xKey;\n        },\n        set: function (value) {\n            if (this._xKey !== value) {\n                this._xKey = value;\n                this.xData = [];\n                this.scheduleData();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BarSeries.prototype, \"xName\", {\n        get: function () {\n            return this._xName;\n        },\n        set: function (value) {\n            if (this._xName !== value) {\n                this._xName = value;\n                this.update();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BarSeries.prototype, \"yKeys\", {\n        get: function () {\n            return this._yKeys;\n        },\n        set: function (values) {\n            if (!equal(this._yKeys, values)) {\n                this._yKeys = values;\n                this.yData = [];\n                var seriesItemEnabled_1 = this.seriesItemEnabled;\n                seriesItemEnabled_1.clear();\n                values.forEach(function (key) { return seriesItemEnabled_1.set(key, true); });\n                var groupScale = this.groupScale;\n                groupScale.domain = values;\n                groupScale.padding = 0.1;\n                groupScale.round = true;\n                this.scheduleData();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BarSeries.prototype, \"yNames\", {\n        get: function () {\n            return this._yNames;\n        },\n        set: function (values) {\n            this._yNames = values;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    BarSeries.prototype.setColors = function (fills, strokes) {\n        this.fills = fills;\n        this.strokes = strokes;\n    };\n    Object.defineProperty(BarSeries.prototype, \"normalizedTo\", {\n        get: function () {\n            return this._normalizedTo;\n        },\n        set: function (value) {\n            var absValue = value ? Math.abs(value) : undefined;\n            if (this._normalizedTo !== absValue) {\n                this._normalizedTo = absValue;\n                this.scheduleData();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BarSeries.prototype, \"strokeWidth\", {\n        get: function () {\n            return this._strokeWidth;\n        },\n        set: function (value) {\n            if (this._strokeWidth !== value) {\n                this._strokeWidth = value;\n                this.update();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BarSeries.prototype, \"shadow\", {\n        get: function () {\n            return this._shadow;\n        },\n        set: function (value) {\n            if (this._shadow !== value) {\n                this._shadow = value;\n                this.update();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    BarSeries.prototype.onHighlightChange = function () {\n        this.updateRectNodes();\n    };\n    BarSeries.prototype.processData = function () {\n        var _a = this, xKey = _a.xKey, yKeys = _a.yKeys, seriesItemEnabled = _a.seriesItemEnabled;\n        var data = xKey && yKeys.length && this.data ? this.data : [];\n        // If the data is an array of rows like so:\n        //\n        // [{\n        //   xKey: 'Jan',\n        //   yKey1: 5,\n        //   yKey2: 7,\n        //   yKey3: -9,\n        // }, {\n        //   xKey: 'Feb',\n        //   yKey1: 10,\n        //   yKey2: -15,\n        //   yKey3: 20\n        // }]\n        //\n        var keysFound = true; // only warn once\n        this.xData = data.map(function (datum) {\n            if (keysFound && !(xKey in datum)) {\n                keysFound = false;\n                console.warn(\"The key '\" + xKey + \"' was not found in the data: \", datum);\n            }\n            return datum[xKey];\n        });\n        this.yData = data.map(function (datum) { return yKeys.map(function (yKey) {\n            if (keysFound && !(yKey in datum)) {\n                keysFound = false;\n                console.warn(\"The key '\" + yKey + \"' was not found in the data: \", datum);\n            }\n            var value = datum[yKey];\n            return isFinite(value) && seriesItemEnabled.get(yKey) ? value : 0;\n        }); });\n        // xData: ['Jan', 'Feb']\n        //\n        // yData: [\n        //   [5, 7, -9],\n        //   [10, -15, 20]\n        // ]\n        var yMinMax = this.yData.map(function (values) { return findMinMax(values); }); // used for normalization of stacked bars\n        var _b = this, yData = _b.yData, normalizedTo = _b.normalizedTo;\n        var yMin = Infinity;\n        var yMax = -Infinity;\n        if (this.grouped) {\n            // Find the tallest positive/negative bar in each group,\n            // then find the tallest positive/negative bar overall.\n            // The `yMin` should always be <= 0,\n            // otherwise with the `yData` like [300, 200, 100] the last bar\n            // will have zero height, because the y-axis range is [100, 300].\n            yMin = Math.min.apply(Math, __spreadArrays([0], yData.map(function (values) { return Math.min.apply(Math, values); })));\n            yMax = Math.max.apply(Math, yData.map(function (values) { return Math.max.apply(Math, values); }));\n        }\n        else { // stacked or regular\n            var yLargestMinMax = findLargestMinMax(yMinMax);\n            if (normalizedTo && isFinite(normalizedTo)) {\n                yMin = yLargestMinMax.min < 0 ? -normalizedTo : 0;\n                yMax = normalizedTo;\n                yData.forEach(function (stackValues, i) { return stackValues.forEach(function (y, j) {\n                    if (y < 0) {\n                        stackValues[j] = -y / yMinMax[i].min * normalizedTo;\n                    }\n                    else {\n                        stackValues[j] = y / yMinMax[i].max * normalizedTo;\n                    }\n                }); });\n            }\n            else {\n                yMin = yLargestMinMax.min;\n                yMax = yLargestMinMax.max;\n            }\n        }\n        this.yDomain = this.fixNumericExtent([yMin, yMax], 'y');\n        this.fireEvent({ type: 'dataProcessed' });\n        return true;\n    };\n    BarSeries.prototype.getDomain = function (direction) {\n        if (this.flipXY) {\n            direction = flipChartAxisDirection(direction);\n        }\n        if (direction === ChartAxisDirection.X) {\n            return this.xData;\n        }\n        else {\n            return this.yDomain;\n        }\n    };\n    BarSeries.prototype.fireNodeClickEvent = function (datum) {\n        this.fireEvent({\n            type: 'nodeClick',\n            series: this,\n            datum: datum.seriesDatum,\n            xKey: this.xKey,\n            yKey: datum.yKey\n        });\n    };\n    BarSeries.prototype.generateNodeData = function () {\n        var _this = this;\n        if (!this.data) {\n            return [];\n        }\n        var flipXY = this.flipXY;\n        var xAxis = flipXY ? this.yAxis : this.xAxis;\n        var yAxis = flipXY ? this.xAxis : this.yAxis;\n        var xScale = xAxis.scale;\n        var yScale = yAxis.scale;\n        var _a = this, groupScale = _a.groupScale, yKeys = _a.yKeys, fills = _a.fills, strokes = _a.strokes, grouped = _a.grouped, strokeWidth = _a.strokeWidth, seriesItemEnabled = _a.seriesItemEnabled, data = _a.data, xData = _a.xData, yData = _a.yData;\n        var label = this.label;\n        var labelFontStyle = label.fontStyle;\n        var labelFontWeight = label.fontWeight;\n        var labelFontSize = label.fontSize;\n        var labelFontFamily = label.fontFamily;\n        var labelColor = label.color;\n        var labelFormatter = label.formatter;\n        groupScale.range = [0, xScale.bandwidth];\n        var barWidth = grouped ? groupScale.bandwidth : xScale.bandwidth;\n        var nodeData = [];\n        xData.forEach(function (category, i) {\n            var yDatum = yData[i];\n            var seriesDatum = data[i];\n            var x = xScale.convert(category);\n            var prevMin = 0;\n            var prevMax = 0;\n            for (var j = 0; j < yDatum.length; j++) {\n                var curr = yDatum[j];\n                var yKey = yKeys[j];\n                var barX = grouped ? x + groupScale.convert(yKey) : x;\n                if (!xAxis.inRange(barX, barWidth)) {\n                    continue;\n                }\n                var prev = curr < 0 ? prevMin : prevMax;\n                var y = yScale.convert(grouped ? curr : prev + curr);\n                var bottomY = yScale.convert(grouped ? 0 : prev);\n                var yValue = seriesDatum[yKey]; // unprocessed y-value\n                var yValueIsNumber = typeof yValue === 'number';\n                var labelText = void 0;\n                if (labelFormatter) {\n                    labelText = labelFormatter({ value: yValueIsNumber ? yValue : undefined });\n                }\n                else {\n                    labelText = yValueIsNumber && isFinite(yValue) ? yValue.toFixed(2) : '';\n                }\n                nodeData.push({\n                    series: _this,\n                    seriesDatum: seriesDatum,\n                    yValue: yValue,\n                    yKey: yKey,\n                    x: flipXY ? Math.min(y, bottomY) : barX,\n                    y: flipXY ? barX : Math.min(y, bottomY),\n                    width: flipXY ? Math.abs(bottomY - y) : barWidth,\n                    height: flipXY ? barWidth : Math.abs(bottomY - y),\n                    fill: fills[j % fills.length],\n                    stroke: strokes[j % strokes.length],\n                    strokeWidth: strokeWidth,\n                    label: seriesItemEnabled.get(yKey) && labelText ? {\n                        text: labelText,\n                        fontStyle: labelFontStyle,\n                        fontWeight: labelFontWeight,\n                        fontSize: labelFontSize,\n                        fontFamily: labelFontFamily,\n                        fill: labelColor,\n                        x: flipXY ? y + (yValue >= 0 ? -1 : 1) * Math.abs(bottomY - y) / 2 : barX + barWidth / 2,\n                        y: flipXY ? barX + barWidth / 2 : y + (yValue >= 0 ? 1 : -1) * Math.abs(bottomY - y) / 2\n                    } : undefined\n                });\n                if (!grouped) {\n                    if (curr < 0) {\n                        prevMin += curr;\n                    }\n                    else {\n                        prevMax += curr;\n                    }\n                }\n            }\n        });\n        return nodeData;\n    };\n    BarSeries.prototype.update = function () {\n        var _a = this, visible = _a.visible, chart = _a.chart, xAxis = _a.xAxis, yAxis = _a.yAxis, xData = _a.xData, yData = _a.yData;\n        this.group.visible = visible;\n        if (!chart || chart.layoutPending || chart.dataPending ||\n            !xAxis || !yAxis || !visible || !xData.length || !yData.length) {\n            return;\n        }\n        var nodeData = this.generateNodeData();\n        this.updateRectSelection(nodeData);\n        this.updateRectNodes();\n        this.updateTextSelection(nodeData);\n        this.updateTextNodes();\n    };\n    BarSeries.prototype.updateRectSelection = function (selectionData) {\n        var updateRects = this.rectSelection.setData(selectionData);\n        updateRects.exit.remove();\n        var enterRects = updateRects.enter.append(Rect).each(function (rect) {\n            rect.tag = BarSeriesNodeTag.Bar;\n            rect.crisp = true;\n        });\n        this.rectSelection = updateRects.merge(enterRects);\n    };\n    BarSeries.prototype.updateRectNodes = function () {\n        var _this = this;\n        if (!this.chart) {\n            return;\n        }\n        var _a = this, fillOpacity = _a.fillOpacity, strokeOpacity = _a.strokeOpacity, _b = _a.highlightStyle, fill = _b.fill, stroke = _b.stroke, shadow = _a.shadow, formatter = _a.formatter, xKey = _a.xKey, flipXY = _a.flipXY;\n        var highlightedDatum = this.chart.highlightedDatum;\n        this.rectSelection.each(function (rect, datum) {\n            var highlighted = datum === highlightedDatum;\n            var rectFill = highlighted && fill !== undefined ? fill : datum.fill;\n            var rectStroke = highlighted && stroke !== undefined ? stroke : datum.stroke;\n            var format = undefined;\n            if (formatter) {\n                format = formatter({\n                    datum: datum.seriesDatum,\n                    fill: rectFill,\n                    stroke: rectStroke,\n                    strokeWidth: datum.strokeWidth,\n                    highlighted: highlighted,\n                    xKey: xKey,\n                    yKey: datum.yKey\n                });\n            }\n            rect.x = datum.x;\n            rect.y = datum.y;\n            rect.width = datum.width;\n            rect.height = datum.height;\n            rect.fill = format && format.fill || rectFill;\n            rect.stroke = format && format.stroke || rectStroke;\n            rect.strokeWidth = format && format.strokeWidth !== undefined ? format.strokeWidth : datum.strokeWidth;\n            rect.fillOpacity = fillOpacity;\n            rect.strokeOpacity = strokeOpacity;\n            rect.lineDash = _this.lineDash;\n            rect.lineDashOffset = _this.lineDashOffset;\n            rect.fillShadow = shadow;\n            // Prevent stroke from rendering for zero height columns and zero width bars.\n            rect.visible = flipXY ? datum.width > 0 : datum.height > 0;\n        });\n    };\n    BarSeries.prototype.updateTextSelection = function (selectionData) {\n        var updateTexts = this.textSelection.setData(selectionData);\n        updateTexts.exit.remove();\n        var enterTexts = updateTexts.enter.append(Text).each(function (text) {\n            text.tag = BarSeriesNodeTag.Label;\n            text.pointerEvents = PointerEvents.None;\n            text.textAlign = 'center';\n            text.textBaseline = 'middle';\n        });\n        this.textSelection = updateTexts.merge(enterTexts);\n    };\n    BarSeries.prototype.updateTextNodes = function () {\n        var labelEnabled = this.label.enabled;\n        this.textSelection.each(function (text, datum) {\n            var label = datum.label;\n            if (label && labelEnabled) {\n                text.fontStyle = label.fontStyle;\n                text.fontWeight = label.fontWeight;\n                text.fontSize = label.fontSize;\n                text.fontFamily = label.fontFamily;\n                text.text = label.text;\n                text.x = label.x;\n                text.y = label.y;\n                text.fill = label.fill;\n                text.visible = true;\n            }\n            else {\n                text.visible = false;\n            }\n        });\n    };\n    BarSeries.prototype.getTooltipHtml = function (nodeDatum) {\n        var xKey = this.xKey;\n        var yKey = nodeDatum.yKey;\n        if (!xKey || !yKey) {\n            return '';\n        }\n        var _a = this, xName = _a.xName, yKeys = _a.yKeys, yNames = _a.yNames, fills = _a.fills, tooltipRenderer = _a.tooltipRenderer;\n        var datum = nodeDatum.seriesDatum;\n        var yKeyIndex = yKeys.indexOf(yKey);\n        var yName = yNames[yKeyIndex];\n        var color = fills[yKeyIndex % fills.length];\n        var xValue = datum[xKey];\n        var yValue = datum[yKey];\n        var xString = typeof xValue === 'number' ? toFixed(xValue) : String(xValue);\n        var yString = typeof yValue === 'number' ? toFixed(yValue) : String(yValue);\n        var title = yName;\n        var content = xString + ': ' + yString;\n        var defaults = {\n            title: title,\n            titleBackgroundColor: color,\n            content: content\n        };\n        if (tooltipRenderer) {\n            return toTooltipHtml(tooltipRenderer({\n                datum: datum,\n                xKey: xKey,\n                xValue: xValue,\n                xName: xName,\n                yKey: yKey,\n                yValue: yValue,\n                yName: yName,\n                color: color\n            }), defaults);\n        }\n        return toTooltipHtml(defaults);\n    };\n    BarSeries.prototype.listSeriesItems = function (legendData) {\n        var _a = this, id = _a.id, data = _a.data, xKey = _a.xKey, yKeys = _a.yKeys, yNames = _a.yNames, seriesItemEnabled = _a.seriesItemEnabled, fills = _a.fills, strokes = _a.strokes, fillOpacity = _a.fillOpacity, strokeOpacity = _a.strokeOpacity;\n        if (data && data.length && xKey && yKeys.length) {\n            yKeys.forEach(function (yKey, index) {\n                legendData.push({\n                    id: id,\n                    itemId: yKey,\n                    enabled: seriesItemEnabled.get(yKey) || false,\n                    label: {\n                        text: yNames[index] || yKeys[index]\n                    },\n                    marker: {\n                        fill: fills[index % fills.length],\n                        stroke: strokes[index % strokes.length],\n                        fillOpacity: fillOpacity,\n                        strokeOpacity: strokeOpacity\n                    }\n                });\n            });\n        }\n    };\n    BarSeries.prototype.toggleSeriesItem = function (itemId, enabled) {\n        var seriesItemEnabled = this.seriesItemEnabled;\n        var enabledSeriesItems = [];\n        seriesItemEnabled.set(itemId, enabled);\n        seriesItemEnabled.forEach(function (enabled, yKey) {\n            if (enabled) {\n                enabledSeriesItems.push(yKey);\n            }\n        });\n        this.groupScale.domain = enabledSeriesItems;\n        this.scheduleData();\n    };\n    BarSeries.className = 'BarSeries';\n    BarSeries.type = 'bar';\n    __decorate([\n        reactive('layoutChange')\n    ], BarSeries.prototype, \"flipXY\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], BarSeries.prototype, \"fills\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], BarSeries.prototype, \"strokes\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], BarSeries.prototype, \"fillOpacity\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], BarSeries.prototype, \"strokeOpacity\", void 0);\n    __decorate([\n        reactive('update')\n    ], BarSeries.prototype, \"lineDash\", void 0);\n    __decorate([\n        reactive('update')\n    ], BarSeries.prototype, \"lineDashOffset\", void 0);\n    __decorate([\n        reactive('update')\n    ], BarSeries.prototype, \"formatter\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], BarSeries.prototype, \"grouped\", void 0);\n    return BarSeries;\n}(CartesianSeries));\nexport { BarSeries };\n"]},"metadata":{},"sourceType":"module"}